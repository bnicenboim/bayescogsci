<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Contrast coding with two predictor variables | Introduction to Bayesian Data Analysis for Cognitive Science</title>
  <meta name="description" content="Introduction to Bayesian data analysis for Cognitive Science." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Contrast coding with two predictor variables | Introduction to Bayesian Data Analysis for Cognitive Science" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bruno.nicenboim.me/bayescogsci/images/temporarycover.jpg" />
  <meta property="og:description" content="Introduction to Bayesian data analysis for Cognitive Science." />
  <meta name="github-repo" content="https://github.com/bnicenboim/bayescogsci" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Contrast coding with two predictor variables | Introduction to Bayesian Data Analysis for Cognitive Science" />
  
  <meta name="twitter:description" content="Introduction to Bayesian data analysis for Cognitive Science." />
  <meta name="twitter:image" content="https://bruno.nicenboim.me/bayescogsci/images/temporarycover.jpg" />

<meta name="author" content="Bruno Nicenboim, Daniel J. Schad, and Shravan Vasishth" />


<meta name="date" content="2025-02-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-contr.html"/>
<link rel="next" href="ch-introstan.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block/empty-anchor.js"></script>
<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/kePrint/kePrint.js"></script>
<link href="libs/lightable/lightable.css" rel="stylesheet" />
<script>
// FOLD code from 
// https://github.com/bblodfon/rtemps/blob/master/docs/bookdown-lite/hide_code.html
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<script data-goatcounter="https://bayescogsci.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Data Analysis for Cognitive Science (DRAFT)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-read-this-book-and-what-is-its-target-audience"><i class="fa fa-check"></i>Why read this book, and what is its target audience?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#developing-the-right-mindset-for-this-book"><i class="fa fa-check"></i>Developing the right mindset for this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-read-this-book"><i class="fa fa-check"></i>How to read this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#some-conventions-used-in-this-book"><i class="fa fa-check"></i>Some conventions used in this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#online-materials"><i class="fa fa-check"></i>Online materials</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-needed"><i class="fa fa-check"></i>Software needed</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="part"><span><b>I Foundational ideas</b></span></li>
<li class="chapter" data-level="1" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-intro.html"><a href="ch-intro.html#introprob"><i class="fa fa-check"></i><b>1.1</b> Probability</a></li>
<li class="chapter" data-level="1.2" data-path="ch-intro.html"><a href="ch-intro.html#condprob"><i class="fa fa-check"></i><b>1.2</b>  Conditional probability</a></li>
<li class="chapter" data-level="1.3" data-path="ch-intro.html"><a href="ch-intro.html#the-law-of-total-probability"><i class="fa fa-check"></i><b>1.3</b> The  law of total probability</a></li>
<li class="chapter" data-level="1.4" data-path="ch-intro.html"><a href="ch-intro.html#sec-binomialcloze"><i class="fa fa-check"></i><b>1.4</b>  Discrete random variables: An example using the  binomial distribution</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="ch-intro.html"><a href="ch-intro.html#the-mean-and-variance-of-the-binomial-distribution"><i class="fa fa-check"></i><b>1.4.1</b> The mean and variance of the binomial distribution</a></li>
<li class="chapter" data-level="1.4.2" data-path="ch-intro.html"><a href="ch-intro.html#what-information-does-a-probability-distribution-provide"><i class="fa fa-check"></i><b>1.4.2</b> What information does a probability distribution provide?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="ch-intro.html"><a href="ch-intro.html#continuous-random-variables-an-example-using-the-normal-distribution"><i class="fa fa-check"></i><b>1.5</b>  Continuous random variables: An example using the  normal distribution</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="ch-intro.html"><a href="ch-intro.html#an-important-distinction-probability-vs.-density-in-a-continuous-random-variable"><i class="fa fa-check"></i><b>1.5.1</b> An important distinction: probability vs. density in a continuous random variable</a></li>
<li class="chapter" data-level="1.5.2" data-path="ch-intro.html"><a href="ch-intro.html#truncating-a-normal-distribution"><i class="fa fa-check"></i><b>1.5.2</b> Truncating a normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="ch-intro.html"><a href="ch-intro.html#bivariate-and-multivariate-distributions"><i class="fa fa-check"></i><b>1.6</b> Bivariate and multivariate distributions</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="ch-intro.html"><a href="ch-intro.html#example-1-discrete-bivariate-distributions"><i class="fa fa-check"></i><b>1.6.1</b> Example 1:  Discrete bivariate distributions</a></li>
<li class="chapter" data-level="1.6.2" data-path="ch-intro.html"><a href="ch-intro.html#sec-contbivar"><i class="fa fa-check"></i><b>1.6.2</b> Example 2: Continuous bivariate distributions</a></li>
<li class="chapter" data-level="1.6.3" data-path="ch-intro.html"><a href="ch-intro.html#sec-generatebivariatedata"><i class="fa fa-check"></i><b>1.6.3</b> Generate simulated bivariate (or multivariate) data</a></li>
<li class="chapter" data-level="1.6.4" data-path="ch-intro.html"><a href="ch-intro.html#sec-decomposevcovmatrix"><i class="fa fa-check"></i><b>1.6.4</b> Decomposing a variance-covariance matrix</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="ch-intro.html"><a href="ch-intro.html#sec-marginal"><i class="fa fa-check"></i><b>1.7</b> An important concept: The marginal likelihood (integrating out a parameter)</a></li>
<li class="chapter" data-level="1.8" data-path="ch-intro.html"><a href="ch-intro.html#summary-of-some-useful-r-functions"><i class="fa fa-check"></i><b>1.8</b> Summary of some useful R functions</a></li>
<li class="chapter" data-level="1.9" data-path="ch-intro.html"><a href="ch-intro.html#summary"><i class="fa fa-check"></i><b>1.9</b> Summary</a></li>
<li class="chapter" data-level="1.10" data-path="ch-intro.html"><a href="ch-intro.html#further-reading"><i class="fa fa-check"></i><b>1.10</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-introBDA.html"><a href="ch-introBDA.html"><i class="fa fa-check"></i><b>2</b> Introduction to Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch-introBDA.html"><a href="ch-introBDA.html#bayes-rule"><i class="fa fa-check"></i><b>2.1</b>  Bayes’ rule</a></li>
<li class="chapter" data-level="2.2" data-path="ch-introBDA.html"><a href="ch-introBDA.html#sec-analytical"><i class="fa fa-check"></i><b>2.2</b> Deriving the  posterior using Bayes’ rule: An analytical example</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch-introBDA.html"><a href="ch-introBDA.html#choosing-a-likelihood"><i class="fa fa-check"></i><b>2.2.1</b> Choosing a  likelihood</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch-introBDA.html"><a href="ch-introBDA.html#sec-choosepriortheta"><i class="fa fa-check"></i><b>2.2.2</b> Choosing a  prior for <span class="math inline">\(\theta\)</span></a></li>
<li class="chapter" data-level="2.2.3" data-path="ch-introBDA.html"><a href="ch-introBDA.html#using-bayes-rule-to-compute-the-posterior-pthetank"><i class="fa fa-check"></i><b>2.2.3</b> Using  Bayes’ rule to compute the  posterior <span class="math inline">\(p(\theta|n,k)\)</span></a></li>
<li class="chapter" data-level="2.2.4" data-path="ch-introBDA.html"><a href="ch-introBDA.html#summary-of-the-procedure"><i class="fa fa-check"></i><b>2.2.4</b> Summary of the procedure</a></li>
<li class="chapter" data-level="2.2.5" data-path="ch-introBDA.html"><a href="ch-introBDA.html#visualizing-the-prior-likelihood-and-posterior"><i class="fa fa-check"></i><b>2.2.5</b> Visualizing the prior, likelihood, and posterior</a></li>
<li class="chapter" data-level="2.2.6" data-path="ch-introBDA.html"><a href="ch-introBDA.html#the-posterior-distribution-is-a-compromise-between-the-prior-and-the-likelihood"><i class="fa fa-check"></i><b>2.2.6</b> The  posterior distribution is a compromise between the prior and the likelihood</a></li>
<li class="chapter" data-level="2.2.7" data-path="ch-introBDA.html"><a href="ch-introBDA.html#incremental-knowledge-gain-using-prior-knowledge"><i class="fa fa-check"></i><b>2.2.7</b> Incremental knowledge gain using prior knowledge</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch-introBDA.html"><a href="ch-introBDA.html#summary-1"><i class="fa fa-check"></i><b>2.3</b> Summary</a></li>
<li class="chapter" data-level="2.4" data-path="ch-introBDA.html"><a href="ch-introBDA.html#further-reading-1"><i class="fa fa-check"></i><b>2.4</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>II Regression models with brms</b></span></li>
<li class="chapter" data-level="3" data-path="ch-compbda.html"><a href="ch-compbda.html"><i class="fa fa-check"></i><b>3</b> Computational Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-compbda.html"><a href="ch-compbda.html#sec-sampling"><i class="fa fa-check"></i><b>3.1</b> Deriving the  posterior through  sampling</a></li>
<li class="chapter" data-level="3.2" data-path="ch-compbda.html"><a href="ch-compbda.html#bayesian-regression-models-using-stan-brms"><i class="fa fa-check"></i><b>3.2</b>  Bayesian Regression Models using Stan:  brms</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ch-compbda.html"><a href="ch-compbda.html#sec-simplenormal"><i class="fa fa-check"></i><b>3.2.1</b> A simple linear model: A single subject pressing a button repeatedly (a finger tapping task)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch-compbda.html"><a href="ch-compbda.html#sec-priorpred"><i class="fa fa-check"></i><b>3.3</b> Prior predictive distribution</a></li>
<li class="chapter" data-level="3.4" data-path="ch-compbda.html"><a href="ch-compbda.html#sec-sensitivity"><i class="fa fa-check"></i><b>3.4</b> The influence of priors:  sensitivity analysis</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ch-compbda.html"><a href="ch-compbda.html#flat-uninformative-priors"><i class="fa fa-check"></i><b>3.4.1</b>  Flat, uninformative priors</a></li>
<li class="chapter" data-level="3.4.2" data-path="ch-compbda.html"><a href="ch-compbda.html#regularizing-priors"><i class="fa fa-check"></i><b>3.4.2</b>  Regularizing priors</a></li>
<li class="chapter" data-level="3.4.3" data-path="ch-compbda.html"><a href="ch-compbda.html#principled-priors"><i class="fa fa-check"></i><b>3.4.3</b>  Principled priors</a></li>
<li class="chapter" data-level="3.4.4" data-path="ch-compbda.html"><a href="ch-compbda.html#informative-priors"><i class="fa fa-check"></i><b>3.4.4</b>  Informative priors</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ch-compbda.html"><a href="ch-compbda.html#sec-revisit"><i class="fa fa-check"></i><b>3.5</b> Revisiting the button-pressing example with different priors</a></li>
<li class="chapter" data-level="3.6" data-path="ch-compbda.html"><a href="ch-compbda.html#sec-ppd"><i class="fa fa-check"></i><b>3.6</b>  Posterior predictive distribution</a></li>
<li class="chapter" data-level="3.7" data-path="ch-compbda.html"><a href="ch-compbda.html#the-influence-of-the-likelihood"><i class="fa fa-check"></i><b>3.7</b> The influence of the likelihood</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="ch-compbda.html"><a href="ch-compbda.html#sec-lnfirst"><i class="fa fa-check"></i><b>3.7.1</b> The  log-normal likelihood</a></li>
<li class="chapter" data-level="3.7.2" data-path="ch-compbda.html"><a href="ch-compbda.html#sec-lognormal"><i class="fa fa-check"></i><b>3.7.2</b> Using a log-normal likelihood to fit data from a single subject pressing a button repeatedly</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="ch-compbda.html"><a href="ch-compbda.html#list-of-the-most-important-commands"><i class="fa fa-check"></i><b>3.8</b> List of the most important commands</a></li>
<li class="chapter" data-level="3.9" data-path="ch-compbda.html"><a href="ch-compbda.html#summary-2"><i class="fa fa-check"></i><b>3.9</b> Summary</a></li>
<li class="chapter" data-level="3.10" data-path="ch-compbda.html"><a href="ch-compbda.html#sec-ch3furtherreading"><i class="fa fa-check"></i><b>3.10</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-reg.html"><a href="ch-reg.html"><i class="fa fa-check"></i><b>4</b> Bayesian regression models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-reg.html"><a href="ch-reg.html#sec-pupil"><i class="fa fa-check"></i><b>4.1</b> A first  linear regression: Does attentional load affect pupil size?</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ch-reg.html"><a href="ch-reg.html#likelihood-and-priors"><i class="fa fa-check"></i><b>4.1.1</b>  Likelihood and  priors</a></li>
<li class="chapter" data-level="4.1.2" data-path="ch-reg.html"><a href="ch-reg.html#the-brms-model"><i class="fa fa-check"></i><b>4.1.2</b> The  <code>brms</code> model</a></li>
<li class="chapter" data-level="4.1.3" data-path="ch-reg.html"><a href="ch-reg.html#how-to-communicate-the-results"><i class="fa fa-check"></i><b>4.1.3</b> How to communicate the results?</a></li>
<li class="chapter" data-level="4.1.4" data-path="ch-reg.html"><a href="ch-reg.html#sec-pupiladq"><i class="fa fa-check"></i><b>4.1.4</b> Descriptive adequacy</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ch-reg.html"><a href="ch-reg.html#sec-trial"><i class="fa fa-check"></i><b>4.2</b>  Log-normal model: Does trial affect response times?</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ch-reg.html"><a href="ch-reg.html#likelihood-and-priors-for-the-log-normal-model"><i class="fa fa-check"></i><b>4.2.1</b> Likelihood and priors for the log-normal model</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch-reg.html"><a href="ch-reg.html#the-brms-model-1"><i class="fa fa-check"></i><b>4.2.2</b> The  <code>brms</code> model</a></li>
<li class="chapter" data-level="4.2.3" data-path="ch-reg.html"><a href="ch-reg.html#how-to-communicate-the-results-1"><i class="fa fa-check"></i><b>4.2.3</b> How to communicate the results?</a></li>
<li class="chapter" data-level="4.2.4" data-path="ch-reg.html"><a href="ch-reg.html#descriptive-adequacy"><i class="fa fa-check"></i><b>4.2.4</b> Descriptive adequacy</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ch-reg.html"><a href="ch-reg.html#sec-logistic"><i class="fa fa-check"></i><b>4.3</b>  Logistic regression: Does  set size affect  free recall?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ch-reg.html"><a href="ch-reg.html#the-likelihood-for-the-logistic-regression-model"><i class="fa fa-check"></i><b>4.3.1</b> The likelihood for the logistic regression model</a></li>
<li class="chapter" data-level="4.3.2" data-path="ch-reg.html"><a href="ch-reg.html#sec-priorslogisticregression"><i class="fa fa-check"></i><b>4.3.2</b> Priors for the logistic regression</a></li>
<li class="chapter" data-level="4.3.3" data-path="ch-reg.html"><a href="ch-reg.html#the-brms-model-2"><i class="fa fa-check"></i><b>4.3.3</b> The <code>brms</code> model</a></li>
<li class="chapter" data-level="4.3.4" data-path="ch-reg.html"><a href="ch-reg.html#sec-comlogis"><i class="fa fa-check"></i><b>4.3.4</b> How to communicate the results?</a></li>
<li class="chapter" data-level="4.3.5" data-path="ch-reg.html"><a href="ch-reg.html#descriptive-adequacy-1"><i class="fa fa-check"></i><b>4.3.5</b>  Descriptive adequacy</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch-reg.html"><a href="ch-reg.html#summary-3"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
<li class="chapter" data-level="4.5" data-path="ch-reg.html"><a href="ch-reg.html#sec-ch4furtherreading"><i class="fa fa-check"></i><b>4.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html"><i class="fa fa-check"></i><b>5</b> Bayesian hierarchical models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#exchangeability-and-hierarchical-models"><i class="fa fa-check"></i><b>5.1</b> Exchangeability and hierarchical models</a></li>
<li class="chapter" data-level="5.2" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#sec-N400hierarchical"><i class="fa fa-check"></i><b>5.2</b> A hierarchical model with a normal likelihood: The N400 effect</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#sec-Mcp"><i class="fa fa-check"></i><b>5.2.1</b>  Complete pooling model (<span class="math inline">\(M_{cp}\)</span>)</a></li>
<li class="chapter" data-level="5.2.2" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#no-pooling-model-m_np"><i class="fa fa-check"></i><b>5.2.2</b>  No pooling model (<span class="math inline">\(M_{np}\)</span>)</a></li>
<li class="chapter" data-level="5.2.3" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#sec-uncorrelated"><i class="fa fa-check"></i><b>5.2.3</b>  Varying intercepts and  varying slopes model (<span class="math inline">\(M_{v}\)</span>)</a></li>
<li class="chapter" data-level="5.2.4" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#sec-mcvivs"><i class="fa fa-check"></i><b>5.2.4</b> Correlated varying intercept varying slopes model (<span class="math inline">\(M_{h}\)</span>)</a></li>
<li class="chapter" data-level="5.2.5" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#sec-sih"><i class="fa fa-check"></i><b>5.2.5</b> By-subjects and by-items correlated varying intercept varying slopes model (<span class="math inline">\(M_{sih}\)</span>)</a></li>
<li class="chapter" data-level="5.2.6" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#sec-distrmodel"><i class="fa fa-check"></i><b>5.2.6</b> Beyond the maximal model–Distributional regression models</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#sec-stroop"><i class="fa fa-check"></i><b>5.3</b> A  hierarchical log-normal model: The  Stroop effect</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#a-correlated-varying-intercept-varying-slopes-log-normal-model"><i class="fa fa-check"></i><b>5.3.1</b> A correlated varying intercept varying slopes  log-normal model</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#why-fitting-a-bayesian-hierarchical-model-is-worth-the-effort"><i class="fa fa-check"></i><b>5.4</b> Why fitting a Bayesian hierarchical model is worth the effort</a></li>
<li class="chapter" data-level="5.5" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#summary-4"><i class="fa fa-check"></i><b>5.5</b> Summary</a></li>
<li class="chapter" data-level="5.6" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html#further-reading-2"><i class="fa fa-check"></i><b>5.6</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-contr.html"><a href="ch-contr.html"><i class="fa fa-check"></i><b>6</b> Contrast coding</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-contr.html"><a href="ch-contr.html#basic-concepts-illustrated-using-a-two-level-factor"><i class="fa fa-check"></i><b>6.1</b> Basic concepts illustrated using a two-level factor</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ch-contr.html"><a href="ch-contr.html#treatmentcontrasts"><i class="fa fa-check"></i><b>6.1.1</b> Default contrast coding:  Treatment contrasts</a></li>
<li class="chapter" data-level="6.1.2" data-path="ch-contr.html"><a href="ch-contr.html#inverseMatrix"><i class="fa fa-check"></i><b>6.1.2</b> Defining comparisons</a></li>
<li class="chapter" data-level="6.1.3" data-path="ch-contr.html"><a href="ch-contr.html#effectcoding"><i class="fa fa-check"></i><b>6.1.3</b>  Sum contrasts</a></li>
<li class="chapter" data-level="6.1.4" data-path="ch-contr.html"><a href="ch-contr.html#sec-cellMeans"><i class="fa fa-check"></i><b>6.1.4</b>  Cell means parameterization and  posterior comparisons</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ch-contr.html"><a href="ch-contr.html#the-hypothesis-matrix-illustrated-with-a-three-level-factor"><i class="fa fa-check"></i><b>6.2</b> The hypothesis matrix illustrated with a three-level factor</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ch-contr.html"><a href="ch-contr.html#sumcontrasts"><i class="fa fa-check"></i><b>6.2.1</b>  Sum contrasts</a></li>
<li class="chapter" data-level="6.2.2" data-path="ch-contr.html"><a href="ch-contr.html#the-hypothesis-matrix"><i class="fa fa-check"></i><b>6.2.2</b> The  hypothesis matrix</a></li>
<li class="chapter" data-level="6.2.3" data-path="ch-contr.html"><a href="ch-contr.html#generating-contrasts-the-hypr-package"><i class="fa fa-check"></i><b>6.2.3</b> Generating contrasts: The  <code>hypr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ch-contr.html"><a href="ch-contr.html#sec-4levelFactor"><i class="fa fa-check"></i><b>6.3</b> Other types of contrasts: illustration with a factor of four levels</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ch-contr.html"><a href="ch-contr.html#repeatedcontrasts"><i class="fa fa-check"></i><b>6.3.1</b>  Repeated contrasts</a></li>
<li class="chapter" data-level="6.3.2" data-path="ch-contr.html"><a href="ch-contr.html#helmertcontrasts"><i class="fa fa-check"></i><b>6.3.2</b>  Helmert contrasts</a></li>
<li class="chapter" data-level="6.3.3" data-path="ch-contr.html"><a href="ch-contr.html#contrasts-in-linear-regression-analysis-the-design-or-model-matrix"><i class="fa fa-check"></i><b>6.3.3</b> Contrasts in linear regression analysis: The design or  model matrix</a></li>
<li class="chapter" data-level="6.3.4" data-path="ch-contr.html"><a href="ch-contr.html#polynomialContrasts"><i class="fa fa-check"></i><b>6.3.4</b>  Polynomial contrasts</a></li>
<li class="chapter" data-level="6.3.5" data-path="ch-contr.html"><a href="ch-contr.html#an-alternative-to-contrasts-monotonic-effects"><i class="fa fa-check"></i><b>6.3.5</b> An alternative to contrasts:  Monotonic effects</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ch-contr.html"><a href="ch-contr.html#nonOrthogonal"><i class="fa fa-check"></i><b>6.4</b> What makes a good set of contrasts?</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ch-contr.html"><a href="ch-contr.html#centered-contrasts"><i class="fa fa-check"></i><b>6.4.1</b>  Centered contrasts</a></li>
<li class="chapter" data-level="6.4.2" data-path="ch-contr.html"><a href="ch-contr.html#orthogonal-contrasts"><i class="fa fa-check"></i><b>6.4.2</b>  Orthogonal contrasts</a></li>
<li class="chapter" data-level="6.4.3" data-path="ch-contr.html"><a href="ch-contr.html#the-role-of-the-intercept-in-non-centered-contrasts"><i class="fa fa-check"></i><b>6.4.3</b> The role of the  intercept in  non-centered contrasts</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ch-contr.html"><a href="ch-contr.html#computing-condition-means-from-estimated-contrasts"><i class="fa fa-check"></i><b>6.5</b> Computing condition means from estimated contrasts</a></li>
<li class="chapter" data-level="6.6" data-path="ch-contr.html"><a href="ch-contr.html#summary-5"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
<li class="chapter" data-level="6.7" data-path="ch-contr.html"><a href="ch-contr.html#further-reading-3"><i class="fa fa-check"></i><b>6.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html"><i class="fa fa-check"></i><b>7</b> Contrast coding with two predictor variables</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html#sec-MR-ANOVA"><i class="fa fa-check"></i><b>7.1</b> Contrast coding in a factorial <span class="math inline">\(2 \times 2\)</span> design</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html#nestedEffects"><i class="fa fa-check"></i><b>7.1.1</b>  Nested effects</a></li>
<li class="chapter" data-level="7.1.2" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html#interactions-between-contrasts"><i class="fa fa-check"></i><b>7.1.2</b>  Interactions between contrasts</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html#sec-contrast-covariate"><i class="fa fa-check"></i><b>7.2</b> One factor and one  covariate</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html#estimating-a-group-difference-and-controlling-for-a-covariate"><i class="fa fa-check"></i><b>7.2.1</b> Estimating a  group difference and controlling for a covariate</a></li>
<li class="chapter" data-level="7.2.2" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html#estimating-differences-in-slopes"><i class="fa fa-check"></i><b>7.2.2</b> Estimating differences in slopes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html#sec-interactions-NLM"><i class="fa fa-check"></i><b>7.3</b> Interactions in generalized linear models (with non-linear link functions) and non-linear models</a></li>
<li class="chapter" data-level="7.4" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html#summary-6"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
<li class="chapter" data-level="7.5" data-path="ch-coding2x2.html"><a href="ch-coding2x2.html#further-reading-4"><i class="fa fa-check"></i><b>7.5</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>III Advanced models with Stan</b></span></li>
<li class="chapter" data-level="8" data-path="ch-introstan.html"><a href="ch-introstan.html"><i class="fa fa-check"></i><b>8</b> Introduction to the probabilistic programming language Stan</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch-introstan.html"><a href="ch-introstan.html#stan-syntax"><i class="fa fa-check"></i><b>8.1</b> Stan syntax</a></li>
<li class="chapter" data-level="8.2" data-path="ch-introstan.html"><a href="ch-introstan.html#sec-firststan"><i class="fa fa-check"></i><b>8.2</b> A first simple example with Stan:  Normal likelihood</a></li>
<li class="chapter" data-level="8.3" data-path="ch-introstan.html"><a href="ch-introstan.html#sec-clozestan"><i class="fa fa-check"></i><b>8.3</b> Another simple example:  Cloze probability with Stan with the  binomial likelihood</a></li>
<li class="chapter" data-level="8.4" data-path="ch-introstan.html"><a href="ch-introstan.html#regression-models-in-stan"><i class="fa fa-check"></i><b>8.4</b>  Regression models in Stan</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="ch-introstan.html"><a href="ch-introstan.html#sec-pupilstan"><i class="fa fa-check"></i><b>8.4.1</b> A first  linear regression in Stan: Does attentional load affect  pupil size?</a></li>
<li class="chapter" data-level="8.4.2" data-path="ch-introstan.html"><a href="ch-introstan.html#sec-interstan"><i class="fa fa-check"></i><b>8.4.2</b>  Interactions in Stan: Does attentional load interact with trial number affecting  pupil size?</a></li>
<li class="chapter" data-level="8.4.3" data-path="ch-introstan.html"><a href="ch-introstan.html#sec-logisticstan"><i class="fa fa-check"></i><b>8.4.3</b>  Logistic regression in Stan: Does set size and trial affect free recall?</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ch-introstan.html"><a href="ch-introstan.html#summary-7"><i class="fa fa-check"></i><b>8.5</b> Summary</a></li>
<li class="chapter" data-level="8.6" data-path="ch-introstan.html"><a href="ch-introstan.html#further-reading-5"><i class="fa fa-check"></i><b>8.6</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-complexstan.html"><a href="ch-complexstan.html"><i class="fa fa-check"></i><b>9</b> Hierarchical models and reparameterization </a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch-complexstan.html"><a href="ch-complexstan.html#sec-hierstan"><i class="fa fa-check"></i><b>9.1</b> Hierarchical models with Stan</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ch-complexstan.html"><a href="ch-complexstan.html#varying-intercept-model-with-stan"><i class="fa fa-check"></i><b>9.1.1</b> Varying intercept model with Stan</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch-complexstan.html"><a href="ch-complexstan.html#sec-uncorrstan"><i class="fa fa-check"></i><b>9.1.2</b> Uncorrelated  varying intercept and slopes model with Stan</a></li>
<li class="chapter" data-level="9.1.3" data-path="ch-complexstan.html"><a href="ch-complexstan.html#sec-corrstan"><i class="fa fa-check"></i><b>9.1.3</b>  Correlated varying intercept varying slopes model</a></li>
<li class="chapter" data-level="9.1.4" data-path="ch-complexstan.html"><a href="ch-complexstan.html#sec-crosscorrstan"><i class="fa fa-check"></i><b>9.1.4</b> By-subject and by-items correlated varying intercept varying slopes model</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch-complexstan.html"><a href="ch-complexstan.html#summary-8"><i class="fa fa-check"></i><b>9.2</b> Summary</a></li>
<li class="chapter" data-level="9.3" data-path="ch-complexstan.html"><a href="ch-complexstan.html#further-reading-6"><i class="fa fa-check"></i><b>9.3</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-custom.html"><a href="ch-custom.html"><i class="fa fa-check"></i><b>10</b> Custom distributions in Stan</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch-custom.html"><a href="ch-custom.html#sec-change"><i class="fa fa-check"></i><b>10.1</b> A change of variables with the reciprocal normal distribution</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="ch-custom.html"><a href="ch-custom.html#scaling-a-probability-density-with-the-jacobian-adjustment"><i class="fa fa-check"></i><b>10.1.1</b> Scaling a probability density with the Jacobian adjustment</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="ch-custom.html"><a href="ch-custom.html#sec-validSBC"><i class="fa fa-check"></i><b>10.2</b>  Validation of a computed posterior distribution</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="ch-custom.html"><a href="ch-custom.html#the-simulation-based-calibration-procedure"><i class="fa fa-check"></i><b>10.2.1</b> The  simulation-based calibration procedure</a></li>
<li class="chapter" data-level="10.2.2" data-path="ch-custom.html"><a href="ch-custom.html#an-example-where-simulation-based-calibration-reveals-a-problem"><i class="fa fa-check"></i><b>10.2.2</b> An example where simulation-based calibration reveals a problem</a></li>
<li class="chapter" data-level="10.2.3" data-path="ch-custom.html"><a href="ch-custom.html#issues-with-and-limitations-of-simulation-based-calibration"><i class="fa fa-check"></i><b>10.2.3</b> Issues with and limitations of simulation-based calibration</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="ch-custom.html"><a href="ch-custom.html#another-custom-distribution-the-exponential-distribution-implemented-manually"><i class="fa fa-check"></i><b>10.3</b> Another  custom distribution: The exponential distribution  implemented manually</a></li>
<li class="chapter" data-level="10.4" data-path="ch-custom.html"><a href="ch-custom.html#summary-9"><i class="fa fa-check"></i><b>10.4</b> Summary</a></li>
<li class="chapter" data-level="10.5" data-path="ch-custom.html"><a href="ch-custom.html#further-reading-7"><i class="fa fa-check"></i><b>10.5</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>IV Evidence synthesis and measurements with error</b></span></li>
<li class="chapter" data-level="11" data-path="ch-remame.html"><a href="ch-remame.html"><i class="fa fa-check"></i><b>11</b>  Meta-analysis and  measurement error models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch-remame.html"><a href="ch-remame.html#meta-analysis"><i class="fa fa-check"></i><b>11.1</b> Meta-analysis</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="ch-remame.html"><a href="ch-remame.html#a-meta-analysis-of-similarity-based-interference-in-sentence-comprehension"><i class="fa fa-check"></i><b>11.1.1</b> A meta-analysis of similarity-based interference in sentence comprehension</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ch-remame.html"><a href="ch-remame.html#measurement-error-models"><i class="fa fa-check"></i><b>11.2</b>  Measurement-error models</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ch-remame.html"><a href="ch-remame.html#accounting-for-measurement-error-in-individual-differences-in-working-memory-capacity-and-reading-fluency"><i class="fa fa-check"></i><b>11.2.1</b> Accounting for measurement error in individual differences in working memory capacity and reading fluency</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch-remame.html"><a href="ch-remame.html#summary-10"><i class="fa fa-check"></i><b>11.3</b> Summary</a></li>
<li class="chapter" data-level="11.4" data-path="ch-remame.html"><a href="ch-remame.html#further-reading-8"><i class="fa fa-check"></i><b>11.4</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>V Model comparison</b></span></li>
<li class="chapter" data-level="12" data-path="ch-comparison.html"><a href="ch-comparison.html"><i class="fa fa-check"></i><b>12</b> Introduction to model comparison</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch-comparison.html"><a href="ch-comparison.html#prior-predictive-vs.-posterior-predictive-model-comparison"><i class="fa fa-check"></i><b>12.1</b> Prior predictive vs. posterior predictive model comparison</a></li>
<li class="chapter" data-level="12.2" data-path="ch-comparison.html"><a href="ch-comparison.html#some-important-points-to-consider-when-comparing-models"><i class="fa fa-check"></i><b>12.2</b> Some important points to consider when comparing models</a></li>
<li class="chapter" data-level="12.3" data-path="ch-comparison.html"><a href="ch-comparison.html#further-reading-9"><i class="fa fa-check"></i><b>12.3</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-bf.html"><a href="ch-bf.html"><i class="fa fa-check"></i><b>13</b> Bayes factors</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-bf.html"><a href="ch-bf.html#hypothesis-testing-using-the-bayes-factor"><i class="fa fa-check"></i><b>13.1</b> Hypothesis testing using the Bayes factor</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ch-bf.html"><a href="ch-bf.html#marginal-likelihood"><i class="fa fa-check"></i><b>13.1.1</b> Marginal likelihood</a></li>
<li class="chapter" data-level="13.1.2" data-path="ch-bf.html"><a href="ch-bf.html#the-bayes-factor"><i class="fa fa-check"></i><b>13.1.2</b> The Bayes factor</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ch-bf.html"><a href="ch-bf.html#sec-N400BF"><i class="fa fa-check"></i><b>13.2</b> Examining the N400 effect with the Bayes factor</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ch-bf.html"><a href="ch-bf.html#sensitivity-analysis-1"><i class="fa fa-check"></i><b>13.2.1</b> Sensitivity analysis</a></li>
<li class="chapter" data-level="13.2.2" data-path="ch-bf.html"><a href="ch-bf.html#sec-BFnonnested"><i class="fa fa-check"></i><b>13.2.2</b>  Non-nested models</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-bf.html"><a href="ch-bf.html#the-influence-of-the-priors-on-bayes-factors-beyond-the-effect-of-interest"><i class="fa fa-check"></i><b>13.3</b> The influence of the priors on Bayes factors: beyond the effect of interest</a></li>
<li class="chapter" data-level="13.4" data-path="ch-bf.html"><a href="ch-bf.html#sec-stanBF"><i class="fa fa-check"></i><b>13.4</b>  The Bayes factor in Stan</a></li>
<li class="chapter" data-level="13.5" data-path="ch-bf.html"><a href="ch-bf.html#bayes-factors-in-theory-and-in-practice"><i class="fa fa-check"></i><b>13.5</b> Bayes factors in theory and in practice</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="ch-bf.html"><a href="ch-bf.html#bayes-factors-in-theory-stability-and-accuracy"><i class="fa fa-check"></i><b>13.5.1</b> Bayes factors in theory: Stability and  accuracy</a></li>
<li class="chapter" data-level="13.5.2" data-path="ch-bf.html"><a href="ch-bf.html#sec-BFvar"><i class="fa fa-check"></i><b>13.5.2</b> Bayes factors in practice: Variability with the data</a></li>
<li class="chapter" data-level="13.5.3" data-path="ch-bf.html"><a href="ch-bf.html#sec-caution"><i class="fa fa-check"></i><b>13.5.3</b> A cautionary note about Bayes factors</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="ch-bf.html"><a href="ch-bf.html#sample-size-determination-using-bayes-factors"><i class="fa fa-check"></i><b>13.6</b> Sample size determination using Bayes factors</a></li>
<li class="chapter" data-level="13.7" data-path="ch-bf.html"><a href="ch-bf.html#summary-11"><i class="fa fa-check"></i><b>13.7</b> Summary</a></li>
<li class="chapter" data-level="13.8" data-path="ch-bf.html"><a href="ch-bf.html#further-reading-10"><i class="fa fa-check"></i><b>13.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ch-cv.html"><a href="ch-cv.html"><i class="fa fa-check"></i><b>14</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ch-cv.html"><a href="ch-cv.html#the-expected-log-predictive-density-of-a-model"><i class="fa fa-check"></i><b>14.1</b> The expected log predictive density of a model</a></li>
<li class="chapter" data-level="14.2" data-path="ch-cv.html"><a href="ch-cv.html#k-fold-and-leave-one-out-cross-validation"><i class="fa fa-check"></i><b>14.2</b> K-fold and leave-one-out cross-validation</a></li>
<li class="chapter" data-level="14.3" data-path="ch-cv.html"><a href="ch-cv.html#testing-the-n400-effect-using-cross-validation"><i class="fa fa-check"></i><b>14.3</b> Testing the N400 effect using cross-validation</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ch-cv.html"><a href="ch-cv.html#cross-validation-with-psis-loo"><i class="fa fa-check"></i><b>14.3.1</b> Cross-validation with PSIS-LOO</a></li>
<li class="chapter" data-level="14.3.2" data-path="ch-cv.html"><a href="ch-cv.html#cross-validation-with-k-fold"><i class="fa fa-check"></i><b>14.3.2</b> Cross-validation with K-fold</a></li>
<li class="chapter" data-level="14.3.3" data-path="ch-cv.html"><a href="ch-cv.html#leave-one-group-out-cross-validation"><i class="fa fa-check"></i><b>14.3.3</b> Leave-one-group-out cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ch-cv.html"><a href="ch-cv.html#sec-logcv"><i class="fa fa-check"></i><b>14.4</b>  Comparing different likelihoods with cross-validation</a></li>
<li class="chapter" data-level="14.5" data-path="ch-cv.html"><a href="ch-cv.html#sec-issuesCV"><i class="fa fa-check"></i><b>14.5</b> Issues with cross-validation</a></li>
<li class="chapter" data-level="14.6" data-path="ch-cv.html"><a href="ch-cv.html#cross-validation-in-stan"><i class="fa fa-check"></i><b>14.6</b> Cross-validation in Stan</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="ch-cv.html"><a href="ch-cv.html#psis-loo-cv-in-stan"><i class="fa fa-check"></i><b>14.6.1</b>  PSIS-LOO-CV in Stan</a></li>
<li class="chapter" data-level="14.6.2" data-path="ch-cv.html"><a href="ch-cv.html#k-fold-cv-in-stan"><i class="fa fa-check"></i><b>14.6.2</b>  K-fold-CV in Stan</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="ch-cv.html"><a href="ch-cv.html#summary-12"><i class="fa fa-check"></i><b>14.7</b> Summary</a></li>
<li class="chapter" data-level="14.8" data-path="ch-cv.html"><a href="ch-cv.html#further-reading-11"><i class="fa fa-check"></i><b>14.8</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>VI Cognitive modeling with Stan</b></span></li>
<li class="chapter" data-level="15" data-path="ch-cogmod.html"><a href="ch-cogmod.html"><i class="fa fa-check"></i><b>15</b> Introduction to cognitive modeling</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ch-cogmod.html"><a href="ch-cogmod.html#what-characterizes-a-computational-cognitive-model"><i class="fa fa-check"></i><b>15.1</b> What characterizes a computational cognitive model?</a></li>
<li class="chapter" data-level="15.2" data-path="ch-cogmod.html"><a href="ch-cogmod.html#some-advantages-of-taking-the-latent-variable-modeling-approach"><i class="fa fa-check"></i><b>15.2</b> Some advantages of taking the latent-variable modeling approach</a></li>
<li class="chapter" data-level="15.3" data-path="ch-cogmod.html"><a href="ch-cogmod.html#types-of-computational-cognitive-model"><i class="fa fa-check"></i><b>15.3</b> Types of computational cognitive model</a></li>
<li class="chapter" data-level="15.4" data-path="ch-cogmod.html"><a href="ch-cogmod.html#summary-13"><i class="fa fa-check"></i><b>15.4</b> Summary</a></li>
<li class="chapter" data-level="15.5" data-path="ch-cogmod.html"><a href="ch-cogmod.html#further-reading-12"><i class="fa fa-check"></i><b>15.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ch-MPT.html"><a href="ch-MPT.html"><i class="fa fa-check"></i><b>16</b> Multinomial processing trees</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ch-MPT.html"><a href="ch-MPT.html#modeling-multiple-categorical-responses"><i class="fa fa-check"></i><b>16.1</b> Modeling  multiple categorical responses</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="ch-MPT.html"><a href="ch-MPT.html#sec-mult"><i class="fa fa-check"></i><b>16.1.1</b> A model for multiple responses using the multinomial likelihood</a></li>
<li class="chapter" data-level="16.1.2" data-path="ch-MPT.html"><a href="ch-MPT.html#sec-cat"><i class="fa fa-check"></i><b>16.1.2</b> A model for multiple responses using the categorical distribution</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="ch-MPT.html"><a href="ch-MPT.html#modeling-picture-naming-abilities-in-aphasia-with-mpt-models"><i class="fa fa-check"></i><b>16.2</b> Modeling picture naming abilities in aphasia with MPT models</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ch-MPT.html"><a href="ch-MPT.html#calculation-of-the-probabilities-in-the-mpt-branches"><i class="fa fa-check"></i><b>16.2.1</b> Calculation of the probabilities in the MPT branches</a></li>
<li class="chapter" data-level="16.2.2" data-path="ch-MPT.html"><a href="ch-MPT.html#sec-mpt-data"><i class="fa fa-check"></i><b>16.2.2</b> A simple MPT model</a></li>
<li class="chapter" data-level="16.2.3" data-path="ch-MPT.html"><a href="ch-MPT.html#sec-MPT-reg"><i class="fa fa-check"></i><b>16.2.3</b> An MPT model assuming by-item variability</a></li>
<li class="chapter" data-level="16.2.4" data-path="ch-MPT.html"><a href="ch-MPT.html#sec-MPT-h"><i class="fa fa-check"></i><b>16.2.4</b> A  hierarchical MPT</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ch-MPT.html"><a href="ch-MPT.html#summary-14"><i class="fa fa-check"></i><b>16.3</b> Summary</a></li>
<li class="chapter" data-level="16.4" data-path="ch-MPT.html"><a href="ch-MPT.html#further-reading-13"><i class="fa fa-check"></i><b>16.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ch-mixture.html"><a href="ch-mixture.html"><i class="fa fa-check"></i><b>17</b> Mixture models</a>
<ul>
<li class="chapter" data-level="17.1" data-path="ch-mixture.html"><a href="ch-mixture.html#a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account"><i class="fa fa-check"></i><b>17.1</b> A mixture model of the speed-accuracy trade-off: The fast-guess model account</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="ch-mixture.html"><a href="ch-mixture.html#the-global-motion-detection-task"><i class="fa fa-check"></i><b>17.1.1</b> The global motion detection task</a></li>
<li class="chapter" data-level="17.1.2" data-path="ch-mixture.html"><a href="ch-mixture.html#sec-simplefastguess"><i class="fa fa-check"></i><b>17.1.2</b> A very simple implementation of the fast-guess model</a></li>
<li class="chapter" data-level="17.1.3" data-path="ch-mixture.html"><a href="ch-mixture.html#sec-multmix"><i class="fa fa-check"></i><b>17.1.3</b> A  multivariate implementation of the fast-guess model</a></li>
<li class="chapter" data-level="17.1.4" data-path="ch-mixture.html"><a href="ch-mixture.html#an-implementation-of-the-fast-guess-model-that-takes-instructions-into-account"><i class="fa fa-check"></i><b>17.1.4</b> An implementation of the fast-guess model that takes instructions into account</a></li>
<li class="chapter" data-level="17.1.5" data-path="ch-mixture.html"><a href="ch-mixture.html#sec-fastguessh"><i class="fa fa-check"></i><b>17.1.5</b> A  hierarchical implementation of the fast-guess model</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="ch-mixture.html"><a href="ch-mixture.html#summary-15"><i class="fa fa-check"></i><b>17.2</b> Summary</a></li>
<li class="chapter" data-level="17.3" data-path="ch-mixture.html"><a href="ch-mixture.html#further-reading-14"><i class="fa fa-check"></i><b>17.3</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html"><i class="fa fa-check"></i><b>18</b> A simple accumulator model to account for choice response time</a>
<ul>
<li class="chapter" data-level="18.1" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html#modeling-a-lexical-decision-task"><i class="fa fa-check"></i><b>18.1</b> Modeling a lexical decision task</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html#sec-acccoding"><i class="fa fa-check"></i><b>18.1.1</b> Modeling the lexical decision task with the log-normal race model</a></li>
<li class="chapter" data-level="18.1.2" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html#sec-genaccum"><i class="fa fa-check"></i><b>18.1.2</b> A generative model for a race between accumulators</a></li>
<li class="chapter" data-level="18.1.3" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html#fitting-the-log-normal-race-model"><i class="fa fa-check"></i><b>18.1.3</b> Fitting the log-normal race model</a></li>
<li class="chapter" data-level="18.1.4" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html#sec-lognormalh"><i class="fa fa-check"></i><b>18.1.4</b> A hierarchical implementation of the log-normal race model</a></li>
<li class="chapter" data-level="18.1.5" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html#sec-contaminant"><i class="fa fa-check"></i><b>18.1.5</b> Dealing with  contaminant responses</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html#posterior-predictive-check-with-the-quantile-probability-plots"><i class="fa fa-check"></i><b>18.2</b> Posterior predictive check with the quantile probability plots</a></li>
<li class="chapter" data-level="18.3" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html#summary-16"><i class="fa fa-check"></i><b>18.3</b> Summary</a></li>
<li class="chapter" data-level="18.4" data-path="ch-lognormalrace.html"><a href="ch-lognormalrace.html#further-reading-15"><i class="fa fa-check"></i><b>18.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ch-closing.html"><a href="ch-closing.html"><i class="fa fa-check"></i><b>19</b> In closing</a></li>
<li class="appendix"><span><b>Online materials</b></span></li>
<li class="chapter" data-level="A" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html"><i class="fa fa-check"></i><b>A</b> Regression models with <code>brms</code> - Extended</a>
<ul>
<li class="chapter" data-level="A.1" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html#app-efficientpriorpd"><i class="fa fa-check"></i><b>A.1</b> An efficient function for generating prior predictive distributions in R</a></li>
<li class="chapter" data-level="A.2" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html#app-truncation"><i class="fa fa-check"></i><b>A.2</b> Truncated distributions</a></li>
<li class="chapter" data-level="A.3" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html#app-intercept"><i class="fa fa-check"></i><b>A.3</b> Intercepts in <code>brms</code></a></li>
<li class="chapter" data-level="A.4" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html#app-lognormal"><i class="fa fa-check"></i><b>A.4</b> Understanding the log-normal likelihood</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html#log-normal-distributions-everywhere"><i class="fa fa-check"></i><b>A.4.1</b> Log-normal distributions everywhere</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html#app-priorR"><i class="fa fa-check"></i><b>A.5</b> Prior predictive checks in R</a></li>
<li class="chapter" data-level="A.6" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html#app-exch"><i class="fa fa-check"></i><b>A.6</b> Finitely exchangeable random variables</a></li>
<li class="chapter" data-level="A.7" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html#app-matrixHierachicalModel"><i class="fa fa-check"></i><b>A.7</b> The Matrix Formulation of Hierarchical Models (the Laird-Ware form)</a></li>
<li class="chapter" data-level="A.8" data-path="regression-models-with-brms---extended.html"><a href="regression-models-with-brms---extended.html#app-cTreatGM"><i class="fa fa-check"></i><b>A.8</b> Treatment contrast with intercept as the grand mean</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="advanced-models-with-stan---extended.html"><a href="advanced-models-with-stan---extended.html"><i class="fa fa-check"></i><b>B</b> Advanced models with Stan - Extended</a>
<ul>
<li class="chapter" data-level="B.1" data-path="advanced-models-with-stan---extended.html"><a href="advanced-models-with-stan---extended.html#app-target"><i class="fa fa-check"></i><b>B.1</b> What does <code>target</code> do in Stan models?</a></li>
<li class="chapter" data-level="B.2" data-path="advanced-models-with-stan---extended.html"><a href="advanced-models-with-stan---extended.html#app-tilde"><i class="fa fa-check"></i><b>B.2</b> Explicitly incrementing the log probability function (<code>target</code>) vs. using the sampling or distribution <code>~</code> notation</a></li>
<li class="chapter" data-level="B.3" data-path="advanced-models-with-stan---extended.html"><a href="advanced-models-with-stan---extended.html#app-cmdstanr"><i class="fa fa-check"></i><b>B.3</b> An alternative R interface to Stan: <code>cmdstanr</code></a></li>
<li class="chapter" data-level="B.4" data-path="advanced-models-with-stan---extended.html"><a href="advanced-models-with-stan---extended.html#app-stancontainers"><i class="fa fa-check"></i><b>B.4</b> Matrix, vector, or array in Stan?</a></li>
<li class="chapter" data-level="B.5" data-path="advanced-models-with-stan---extended.html"><a href="advanced-models-with-stan---extended.html#app-noncenterparam"><i class="fa fa-check"></i><b>B.5</b> A simple non-centered parameterization</a></li>
<li class="chapter" data-level="B.6" data-path="advanced-models-with-stan---extended.html"><a href="advanced-models-with-stan---extended.html#app-cholesky"><i class="fa fa-check"></i><b>B.6</b> Cholesky factorization for reparameterizing hierarchical models with correlations between adjustments to different parameters</a></li>
<li class="chapter" data-level="B.7" data-path="advanced-models-with-stan---extended.html"><a href="advanced-models-with-stan---extended.html#app-sbc"><i class="fa fa-check"></i><b>B.7</b> Different rank visualizations and the <code>SBC</code> package.</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="evidence-synthesis-and-measurements-with-error---extended.html"><a href="evidence-synthesis-and-measurements-with-error---extended.html"><i class="fa fa-check"></i><b>C</b> Evidence synthesis and measurements with error - Extended</a>
<ul>
<li class="chapter" data-level="C.1" data-path="evidence-synthesis-and-measurements-with-error---extended.html"><a href="evidence-synthesis-and-measurements-with-error---extended.html#app-sigmatrue"><i class="fa fa-check"></i><b>C.1</b> What happens if we set <code>sigma = TRUE</code> in <code>resp_se()</code> function in <code>brms</code>?</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="model-comparison---extended.html"><a href="model-comparison---extended.html"><i class="fa fa-check"></i><b>D</b> Model comparison - Extended</a>
<ul>
<li class="chapter" data-level="D.1" data-path="model-comparison---extended.html"><a href="model-comparison---extended.html#app-null"><i class="fa fa-check"></i><b>D.1</b> Credible intervals should not be used to reject a null hypothesis</a></li>
<li class="chapter" data-level="D.2" data-path="model-comparison---extended.html"><a href="model-comparison---extended.html#app-likR"><i class="fa fa-check"></i><b>D.2</b> The likelihood ratio vs the Bayes factor</a></li>
<li class="chapter" data-level="D.3" data-path="model-comparison---extended.html"><a href="model-comparison---extended.html#app-integral"><i class="fa fa-check"></i><b>D.3</b> Approximation of the (expected) log predictive density of a model without integration</a></li>
<li class="chapter" data-level="D.4" data-path="model-comparison---extended.html"><a href="model-comparison---extended.html#app-CV-alg"><i class="fa fa-check"></i><b>D.4</b> The cross-validation algorithm for the expected log predictive density of a model</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="ch-priors.html"><a href="ch-priors.html"><i class="fa fa-check"></i><b>E</b> The Art and Science of Prior Elicitation</a>
<ul>
<li class="chapter" data-level="E.1" data-path="ch-priors.html"><a href="ch-priors.html#sec-simpleexamplepriors"><i class="fa fa-check"></i><b>E.1</b> Eliciting priors from oneself for a self-paced reading study: An example</a>
<ul>
<li class="chapter" data-level="E.1.1" data-path="ch-priors.html"><a href="ch-priors.html#an-example-english-relative-clauses"><i class="fa fa-check"></i><b>E.1.1</b> An example: English  relative clauses</a></li>
<li class="chapter" data-level="E.1.2" data-path="ch-priors.html"><a href="ch-priors.html#eliciting-a-prior-for-the-intercept"><i class="fa fa-check"></i><b>E.1.2</b> Eliciting a prior for the intercept</a></li>
<li class="chapter" data-level="E.1.3" data-path="ch-priors.html"><a href="ch-priors.html#eliciting-a-prior-for-the-slope"><i class="fa fa-check"></i><b>E.1.3</b> Eliciting a prior for the slope</a></li>
<li class="chapter" data-level="E.1.4" data-path="ch-priors.html"><a href="ch-priors.html#sec-varcomppriors"><i class="fa fa-check"></i><b>E.1.4</b> Eliciting priors for the  variance components</a></li>
</ul></li>
<li class="chapter" data-level="E.2" data-path="ch-priors.html"><a href="ch-priors.html#eliciting-priors-from-experts"><i class="fa fa-check"></i><b>E.2</b>  Eliciting priors from experts</a></li>
<li class="chapter" data-level="E.3" data-path="ch-priors.html"><a href="ch-priors.html#deriving-priors-from-meta-analyses"><i class="fa fa-check"></i><b>E.3</b> Deriving priors from  meta-analyses</a></li>
<li class="chapter" data-level="E.4" data-path="ch-priors.html"><a href="ch-priors.html#using-previous-experiments-posteriors-as-priors-for-a-new-study"><i class="fa fa-check"></i><b>E.4</b> Using previous experiments’  posteriors as priors for a new study</a></li>
<li class="chapter" data-level="E.5" data-path="ch-priors.html"><a href="ch-priors.html#summary-17"><i class="fa fa-check"></i><b>E.5</b> Summary</a></li>
<li class="chapter" data-level="E.6" data-path="ch-priors.html"><a href="ch-priors.html#further-reading-16"><i class="fa fa-check"></i><b>E.6</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="ch-workflow.html"><a href="ch-workflow.html"><i class="fa fa-check"></i><b>F</b> Workflow</a>
<ul>
<li class="chapter" data-level="F.1" data-path="ch-workflow.html"><a href="ch-workflow.html#building-a-model"><i class="fa fa-check"></i><b>F.1</b>  Building a model</a></li>
<li class="chapter" data-level="F.2" data-path="ch-workflow.html"><a href="ch-workflow.html#principled-questions-to-ask-on-a-model"><i class="fa fa-check"></i><b>F.2</b> Principled questions to ask on a model</a>
<ul>
<li class="chapter" data-level="F.2.1" data-path="ch-workflow.html"><a href="ch-workflow.html#checking-whether-assumptions-are-consistent-with-domain-expertise-prior-predictive-checks"><i class="fa fa-check"></i><b>F.2.1</b>  Checking whether assumptions are consistent with  domain expertise: Prior predictive checks</a></li>
<li class="chapter" data-level="F.2.2" data-path="ch-workflow.html"><a href="ch-workflow.html#testing-for-correct-posterior-approximations-checks-of-computational-faithfulness"><i class="fa fa-check"></i><b>F.2.2</b>  Testing for correct posterior approximations: Checks of computational faithfulness</a></li>
<li class="chapter" data-level="F.2.3" data-path="ch-workflow.html"><a href="ch-workflow.html#sensitivity-of-the-model"><i class="fa fa-check"></i><b>F.2.3</b>  Sensitivity of the model</a></li>
<li class="chapter" data-level="F.2.4" data-path="ch-workflow.html"><a href="ch-workflow.html#does-the-model-adequately-capture-the-dataposterior-predictive-checks"><i class="fa fa-check"></i><b>F.2.4</b>  Does the model adequately capture the data?–Posterior predictive checks</a></li>
</ul></li>
<li class="chapter" data-level="F.3" data-path="ch-workflow.html"><a href="ch-workflow.html#further-reading-17"><i class="fa fa-check"></i><b>F.3</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>G</b> Exercises</a>
<ul>
<li class="chapter" data-level="G.1" data-path="exercises.html"><a href="exercises.html#sec-Foundationsexercises"><i class="fa fa-check"></i><b>G.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="G.1.1" data-path="exercises.html"><a href="exercises.html#exr:FoundationsexercisespnormPart1"><i class="fa fa-check"></i><b>G.1.1</b> Practice using the <code>pnorm()</code> function–Part 1</a></li>
<li class="chapter" data-level="G.1.2" data-path="exercises.html"><a href="exercises.html#exr:FoundationsexercisespnormPart2"><i class="fa fa-check"></i><b>G.1.2</b> Practice using the <code>pnorm()</code> function–Part 2</a></li>
<li class="chapter" data-level="G.1.3" data-path="exercises.html"><a href="exercises.html#exr:FoundationsexercisespnormPart3"><i class="fa fa-check"></i><b>G.1.3</b> Practice using the <code>pnorm()</code> function–Part 3</a></li>
<li class="chapter" data-level="G.1.4" data-path="exercises.html"><a href="exercises.html#exr:FoundationsexercisesqnormPart1"><i class="fa fa-check"></i><b>G.1.4</b> Practice using the <code>qnorm()</code> function–Part 1</a></li>
<li class="chapter" data-level="G.1.5" data-path="exercises.html"><a href="exercises.html#exr:FoundationsexercisesqnormPart2"><i class="fa fa-check"></i><b>G.1.5</b> Practice using the <code>qnorm()</code> function–Part 2</a></li>
<li class="chapter" data-level="G.1.6" data-path="exercises.html"><a href="exercises.html#exr:Foundationsexercisessamples1"><i class="fa fa-check"></i><b>G.1.6</b> Practice getting summaries from samples–Part 1</a></li>
<li class="chapter" data-level="G.1.7" data-path="exercises.html"><a href="exercises.html#exr:Foundationsexercisessamples2"><i class="fa fa-check"></i><b>G.1.7</b> Practice getting summaries from samples–Part 2.</a></li>
<li class="chapter" data-level="G.1.8" data-path="exercises.html"><a href="exercises.html#exr:Foundationsexercisesvcov1"><i class="fa fa-check"></i><b>G.1.8</b> Practice with a variance-covariance matrix for a bivariate distribution.</a></li>
</ul></li>
<li class="chapter" data-level="G.2" data-path="exercises.html"><a href="exercises.html#sec-BDAexercises"><i class="fa fa-check"></i><b>G.2</b> Introduction to Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="G.2.1" data-path="exercises.html"><a href="exercises.html#exr:BDAexercisesDerivingBayes"><i class="fa fa-check"></i><b>G.2.1</b> Deriving Bayes’ rule</a></li>
<li class="chapter" data-level="G.2.2" data-path="exercises.html"><a href="exercises.html#exr:BDAexercisesConj1"><i class="fa fa-check"></i><b>G.2.2</b> Conjugate forms 1</a></li>
<li class="chapter" data-level="G.2.3" data-path="exercises.html"><a href="exercises.html#exr:BDAexercisesConj2"><i class="fa fa-check"></i><b>G.2.3</b> Conjugate forms 2</a></li>
<li class="chapter" data-level="G.2.4" data-path="exercises.html"><a href="exercises.html#exr:BDAexercisesConj3"><i class="fa fa-check"></i><b>G.2.4</b> Conjugate forms 3</a></li>
<li class="chapter" data-level="G.2.5" data-path="exercises.html"><a href="exercises.html#exr:BDAexercisesConj4"><i class="fa fa-check"></i><b>G.2.5</b> Conjugate forms 4</a></li>
<li class="chapter" data-level="G.2.6" data-path="exercises.html"><a href="exercises.html#exr:BDAexercisesWeightedMean"><i class="fa fa-check"></i><b>G.2.6</b> The posterior mean is a weighted mean of the prior mean and the MLE (Poisson-Gamma conjugate case)</a></li>
</ul></li>
<li class="chapter" data-level="G.3" data-path="exercises.html"><a href="exercises.html#ex:compbda"><i class="fa fa-check"></i><b>G.3</b> Computational Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="G.3.1" data-path="exercises.html"><a href="exercises.html#exr:simulatedlinearmod"><i class="fa fa-check"></i><b>G.3.1</b> Check for parameter recovery in a linear model using simulated data.</a></li>
<li class="chapter" data-level="G.3.2" data-path="exercises.html"><a href="exercises.html#exr:linearmod"><i class="fa fa-check"></i><b>G.3.2</b> A simple linear model.</a></li>
<li class="chapter" data-level="G.3.3" data-path="exercises.html"><a href="exercises.html#exr:compbda-biasedpost"><i class="fa fa-check"></i><b>G.3.3</b> Revisiting the button-pressing example with different priors.</a></li>
<li class="chapter" data-level="G.3.4" data-path="exercises.html"><a href="exercises.html#exr:ppd"><i class="fa fa-check"></i><b>G.3.4</b> Posterior predictive checks with a log-normal model.</a></li>
<li class="chapter" data-level="G.3.5" data-path="exercises.html"><a href="exercises.html#exr:skew"><i class="fa fa-check"></i><b>G.3.5</b> A skew normal distribution.</a></li>
</ul></li>
<li class="chapter" data-level="G.4" data-path="exercises.html"><a href="exercises.html#sec-LMexercises"><i class="fa fa-check"></i><b>G.4</b> Bayesian regression models</a>
<ul>
<li class="chapter" data-level="G.4.1" data-path="exercises.html"><a href="exercises.html#exr:powerposing"><i class="fa fa-check"></i><b>G.4.1</b> A simple linear regression: Power posing and testosterone.</a></li>
<li class="chapter" data-level="G.4.2" data-path="exercises.html"><a href="exercises.html#exr:pupils"><i class="fa fa-check"></i><b>G.4.2</b> Another linear regression model: Revisiting attentional load effect on pupil size.</a></li>
<li class="chapter" data-level="G.4.3" data-path="exercises.html"><a href="exercises.html#exr:lognormalm"><i class="fa fa-check"></i><b>G.4.3</b> Log-normal model: Revisiting the effect of trial on finger tapping times.</a></li>
<li class="chapter" data-level="G.4.4" data-path="exercises.html"><a href="exercises.html#exr:reg-logistic"><i class="fa fa-check"></i><b>G.4.4</b> Logistic regression: Revisiting the effect of set size on free recall.</a></li>
<li class="chapter" data-level="G.4.5" data-path="exercises.html"><a href="exercises.html#exr:red"><i class="fa fa-check"></i><b>G.4.5</b> Red is the sexiest color.</a></li>
</ul></li>
<li class="chapter" data-level="G.5" data-path="exercises.html"><a href="exercises.html#sec-HLMexercises"><i class="fa fa-check"></i><b>G.5</b> Bayesian hierarchical models</a>
<ul>
<li class="chapter" data-level="G.5.1" data-path="exercises.html"><a href="exercises.html#exr:hierarchical-normal"><i class="fa fa-check"></i><b>G.5.1</b> A hierarchical model (normal likelihood) of cognitive load on pupil size.</a></li>
<li class="chapter" data-level="G.5.2" data-path="exercises.html"><a href="exercises.html#exr:hierarchical-logn"><i class="fa fa-check"></i><b>G.5.2</b> Are subject relatives easier to process than object relatives (log-normal likelihood)?</a></li>
<li class="chapter" data-level="G.5.3" data-path="exercises.html"><a href="exercises.html#exr:HLMExerciseMandarinRC"><i class="fa fa-check"></i><b>G.5.3</b> Relative clause processing in Mandarin Chinese</a></li>
<li class="chapter" data-level="G.5.4" data-path="exercises.html"><a href="exercises.html#exr:HLMExerciseEnglishAgrmt"><i class="fa fa-check"></i><b>G.5.4</b>  Agreement attraction in comprehension</a></li>
<li class="chapter" data-level="G.5.5" data-path="exercises.html"><a href="exercises.html#exr:ab"><i class="fa fa-check"></i><b>G.5.5</b>  Attentional blink (Bernoulli likelihood)</a></li>
<li class="chapter" data-level="G.5.6" data-path="exercises.html"><a href="exercises.html#exr:strooplogis-brms"><i class="fa fa-check"></i><b>G.5.6</b> Is there a Stroop effect in accuracy?</a></li>
<li class="chapter" data-level="G.5.7" data-path="exercises.html"><a href="exercises.html#exr:stroop-dist"><i class="fa fa-check"></i><b>G.5.7</b>  Distributional regression for the Stroop effect.</a></li>
<li class="chapter" data-level="G.5.8" data-path="exercises.html"><a href="exercises.html#exr:HLMExerciseGramCE"><i class="fa fa-check"></i><b>G.5.8</b> The  grammaticality illusion</a></li>
</ul></li>
<li class="chapter" data-level="G.6" data-path="exercises.html"><a href="exercises.html#sec-Contrastsexercises"><i class="fa fa-check"></i><b>G.6</b> Contrast coding</a>
<ul>
<li class="chapter" data-level="G.6.1" data-path="exercises.html"><a href="exercises.html#exr:ContrastsPersian"><i class="fa fa-check"></i><b>G.6.1</b> Contrast coding for a four-condition design</a></li>
<li class="chapter" data-level="G.6.2" data-path="exercises.html"><a href="exercises.html#exr:ContrastsNPIHelmert"><i class="fa fa-check"></i><b>G.6.2</b>  Helmert coding for a six-condition design.</a></li>
<li class="chapter" data-level="G.6.3" data-path="exercises.html"><a href="exercises.html#exr:ContrastsNcomparisons"><i class="fa fa-check"></i><b>G.6.3</b> Number of possible comparisons in a single model.</a></li>
</ul></li>
<li class="chapter" data-level="G.7" data-path="exercises.html"><a href="exercises.html#sec-Contrasts2x2exercises"><i class="fa fa-check"></i><b>G.7</b> Contrast coding with two predictor variables</a>
<ul>
<li class="chapter" data-level="G.7.1" data-path="exercises.html"><a href="exercises.html#exr:ContrastsPersianANOVA"><i class="fa fa-check"></i><b>G.7.1</b> ANOVA coding for a four-condition design.</a></li>
<li class="chapter" data-level="G.7.2" data-path="exercises.html"><a href="exercises.html#exr:Contrasts2x2x2Dillon2013"><i class="fa fa-check"></i><b>G.7.2</b> ANOVA and nested comparisons in a <span class="math inline">\(2\times 2\times 2\)</span> design</a></li>
</ul></li>
<li class="chapter" data-level="G.8" data-path="exercises.html"><a href="exercises.html#introduction-to-the-probabilistic-programming-language-stan"><i class="fa fa-check"></i><b>G.8</b> Introduction to the probabilistic programming language Stan</a>
<ul>
<li class="chapter" data-level="G.8.1" data-path="exercises.html"><a href="exercises.html#exr:first"><i class="fa fa-check"></i><b>G.8.1</b> A very simple model.</a></li>
<li class="chapter" data-level="G.8.2" data-path="exercises.html"><a href="exercises.html#exr:badstan"><i class="fa fa-check"></i><b>G.8.2</b> Incorrect Stan model.</a></li>
<li class="chapter" data-level="G.8.3" data-path="exercises.html"><a href="exercises.html#exr:skewstan"><i class="fa fa-check"></i><b>G.8.3</b> Using Stan documentation.</a></li>
<li class="chapter" data-level="G.8.4" data-path="exercises.html"><a href="exercises.html#exr:linkfunction"><i class="fa fa-check"></i><b>G.8.4</b> The probit link function as an alternative to the logit function.</a></li>
<li class="chapter" data-level="G.8.5" data-path="exercises.html"><a href="exercises.html#exr:logisticstan"><i class="fa fa-check"></i><b>G.8.5</b> Examining the position of the queued word on recall.</a></li>
<li class="chapter" data-level="G.8.6" data-path="exercises.html"><a href="exercises.html#exr:fallacy"><i class="fa fa-check"></i><b>G.8.6</b> The conjunction fallacy.</a></li>
</ul></li>
<li class="chapter" data-level="G.9" data-path="exercises.html"><a href="exercises.html#hierarchical-models-and-reparameterization"><i class="fa fa-check"></i><b>G.9</b> Hierarchical models and reparameterization</a>
<ul>
<li class="chapter" data-level="G.9.1" data-path="exercises.html"><a href="exercises.html#exr:stroop"><i class="fa fa-check"></i><b>G.9.1</b> A log-normal model in Stan.</a></li>
<li class="chapter" data-level="G.9.2" data-path="exercises.html"><a href="exercises.html#exr:hierarchical-logn-stan"><i class="fa fa-check"></i><b>G.9.2</b> A by-subjects and by-items hierarchical model with a log-normal likelihood.</a></li>
<li class="chapter" data-level="G.9.3" data-path="exercises.html"><a href="exercises.html#exr:strooplogis"><i class="fa fa-check"></i><b>G.9.3</b> A hierarchical logistic regression with Stan.</a></li>
<li class="chapter" data-level="G.9.4" data-path="exercises.html"><a href="exercises.html#exr:distr-stan"><i class="fa fa-check"></i><b>G.9.4</b> A distributional regression model of the effect of cloze probability on the N400.</a></li>
</ul></li>
<li class="chapter" data-level="G.10" data-path="exercises.html"><a href="exercises.html#sec-customexercises"><i class="fa fa-check"></i><b>G.10</b> Custom distributions in Stan</a>
<ul>
<li class="chapter" data-level="G.10.1" data-path="exercises.html"><a href="exercises.html#exr:shiftedlogn"><i class="fa fa-check"></i><b>G.10.1</b> Fitting a  shifted log-normal distribution.</a></li>
<li class="chapter" data-level="G.10.2" data-path="exercises.html"><a href="exercises.html#exr:wald"><i class="fa fa-check"></i><b>G.10.2</b> Fitting a Wald distribution.</a></li>
</ul></li>
<li class="chapter" data-level="G.11" data-path="exercises.html"><a href="exercises.html#sec-REMAMEexercises"><i class="fa fa-check"></i><b>G.11</b> Meta-analysis and measurement error models</a>
<ul>
<li class="chapter" data-level="G.11.1" data-path="exercises.html"><a href="exercises.html#exr:REMAMEExtracting"><i class="fa fa-check"></i><b>G.11.1</b> Extracting estimates from published papers</a></li>
<li class="chapter" data-level="G.11.2" data-path="exercises.html"><a href="exercises.html#exr:REMAMEBuerki"><i class="fa fa-check"></i><b>G.11.2</b> A meta-analysis of picture-word interference data</a></li>
<li class="chapter" data-level="G.11.3" data-path="exercises.html"><a href="exercises.html#exr:REMAMELiEnglish"><i class="fa fa-check"></i><b>G.11.3</b> Measurement error model for English VOT data</a></li>
</ul></li>
<li class="chapter" data-level="G.12" data-path="exercises.html"><a href="exercises.html#introduction-to-model-comparison"><i class="fa fa-check"></i><b>G.12</b> Introduction to model comparison</a></li>
<li class="chapter" data-level="G.13" data-path="exercises.html"><a href="exercises.html#bayes-factors"><i class="fa fa-check"></i><b>G.13</b> Bayes factors</a>
<ul>
<li class="chapter" data-level="G.13.1" data-path="exercises.html"><a href="exercises.html#exr:bysubjects"><i class="fa fa-check"></i><b>G.13.1</b> Is there evidence for differences in the effect of cloze probability among the subjects?</a></li>
<li class="chapter" data-level="G.13.2" data-path="exercises.html"><a href="exercises.html#exr:bf-logn"><i class="fa fa-check"></i><b>G.13.2</b> Is there evidence for the claim that English subject relative clauses are easier to process than object relative clauses?</a></li>
<li class="chapter" data-level="G.13.3" data-path="exercises.html"><a href="exercises.html#exr:bf-logistic"><i class="fa fa-check"></i><b>G.13.3</b> In the Grodner and Gibson 2005 data, in question-response accuracies, is there evidence for the claim that sentences with subject relative clauses are easier to comprehend?</a></li>
<li class="chapter" data-level="G.13.4" data-path="exercises.html"><a href="exercises.html#exr:lognstan"><i class="fa fa-check"></i><b>G.13.4</b> Bayes factor and bounded parameters using Stan.</a></li>
</ul></li>
<li class="chapter" data-level="G.14" data-path="exercises.html"><a href="exercises.html#cross-validation"><i class="fa fa-check"></i><b>G.14</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="G.14.1" data-path="exercises.html"><a href="exercises.html#exr:logcv"><i class="fa fa-check"></i><b>G.14.1</b> Predictive accuracy of the linear and the logarithm effect of cloze probability.</a></li>
<li class="chapter" data-level="G.14.2" data-path="exercises.html"><a href="exercises.html#exr:stroopcv"><i class="fa fa-check"></i><b>G.14.2</b> Log-normal model</a></li>
<li class="chapter" data-level="G.14.3" data-path="exercises.html"><a href="exercises.html#exr:logrec"><i class="fa fa-check"></i><b>G.14.3</b> Log-normal vs rec-normal model in Stan</a></li>
</ul></li>
<li class="chapter" data-level="G.15" data-path="exercises.html"><a href="exercises.html#introduction-to-cognitive-modeling"><i class="fa fa-check"></i><b>G.15</b> Introduction to cognitive modeling</a></li>
<li class="chapter" data-level="G.16" data-path="exercises.html"><a href="exercises.html#multinomial-processing-trees"><i class="fa fa-check"></i><b>G.16</b> Multinomial processing trees</a>
<ul>
<li class="chapter" data-level="G.16.1" data-path="exercises.html"><a href="exercises.html#exr:mult"><i class="fa fa-check"></i><b>G.16.1</b> Modeling multiple categorical responses.</a></li>
<li class="chapter" data-level="G.16.2" data-path="exercises.html"><a href="exercises.html#exr:mpt-mnm"><i class="fa fa-check"></i><b>G.16.2</b> An alternative MPT to model the picture recognition task.</a></li>
<li class="chapter" data-level="G.16.3" data-path="exercises.html"><a href="exercises.html#exr:edit-mpt-cat"><i class="fa fa-check"></i><b>G.16.3</b> A simple MPT model that incorporates phonological complexity in the picture recognition task.</a></li>
<li class="chapter" data-level="G.16.4" data-path="exercises.html"><a href="exercises.html#exr:mpt"><i class="fa fa-check"></i><b>G.16.4</b> A more hierarchical MPT.</a></li>
<li class="chapter" data-level="G.16.5" data-path="exercises.html"><a href="exercises.html#exr:mpt-adv"><i class="fa fa-check"></i><b>G.16.5</b> <strong>Advanced</strong>: Multinomial processing trees.</a></li>
</ul></li>
<li class="chapter" data-level="G.17" data-path="exercises.html"><a href="exercises.html#mixture-models"><i class="fa fa-check"></i><b>G.17</b> Mixture models</a>
<ul>
<li class="chapter" data-level="G.17.1" data-path="exercises.html"><a href="exercises.html#exr:pcorrect"><i class="fa fa-check"></i><b>G.17.1</b> Changes in the true point values.</a></li>
<li class="chapter" data-level="G.17.2" data-path="exercises.html"><a href="exercises.html#exr:mixhier"><i class="fa fa-check"></i><b>G.17.2</b> RTs in schizophrenic patients and control.</a></li>
<li class="chapter" data-level="G.17.3" data-path="exercises.html"><a href="exercises.html#exr:mixbias"><i class="fa fa-check"></i><b>G.17.3</b> <strong>Advanced:</strong> Guessing bias in the model.</a></li>
</ul></li>
<li class="chapter" data-level="G.18" data-path="exercises.html"><a href="exercises.html#a-simple-accumulator-model-to-account-for-choice-response-time"><i class="fa fa-check"></i><b>G.18</b> A simple accumulator model to account for choice response time</a>
<ul>
<li class="chapter" data-level="G.18.1" data-path="exercises.html"><a href="exercises.html#exr:recovery"><i class="fa fa-check"></i><b>G.18.1</b> Can we recover the true point values of the parameters of a model when dealing with a contaminant distribution?</a></li>
<li class="chapter" data-level="G.18.2" data-path="exercises.html"><a href="exercises.html#exr:lnracescale"><i class="fa fa-check"></i><b>G.18.2</b> Can the log-normal race model account for fast errors?</a></li>
<li class="chapter" data-level="G.18.3" data-path="exercises.html"><a href="exercises.html#exr:lnldt"><i class="fa fa-check"></i><b>G.18.3</b> Accounting for response time and choice in the lexical decision task using the log-normal race model.</a></li>
</ul></li>
<li class="chapter" data-level="G.19" data-path="exercises.html"><a href="exercises.html#sec-priorsexercises"><i class="fa fa-check"></i><b>G.19</b> The Art and Science of  Prior Elicitation</a>
<ul>
<li class="chapter" data-level="G.19.1" data-path="exercises.html"><a href="exercises.html#exr:PriorsRCs"><i class="fa fa-check"></i><b>G.19.1</b> Develop a plausible informative prior for the difference between object and subject relative clause reading times</a></li>
<li class="chapter" data-level="G.19.2" data-path="exercises.html"><a href="exercises.html#exr:Priorslocalcoherence"><i class="fa fa-check"></i><b>G.19.2</b> Extracting an informative prior from a published paper for a future study</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Bayesian Data Analysis for Cognitive Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-coding2x2" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Contrast coding with two predictor variables<a href="ch-coding2x2.html#ch-coding2x2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Chapter <a href="ch-contr.html#ch-contr">6</a> provides a basic introduction into contrast coding in situations where there is one predictor variable, i.e., one factor, whose effects can be estimated using a specified contrast matrix. Here, we investigate how contrast coding generalizes to situations where there is more than one predictor variable. This could either be a situation where two factors are present or where one factor is paired with a continuous predictor variable, i.e., a covariate. We first discuss contrast coding for the case of two factors (for <span class="math inline">\(2 \times 2\)</span> designs; section <a href="ch-coding2x2.html#sec-MR-ANOVA">7.1</a>) and then go on to investigate situations where one predictor is a factor and the other predictor is a covariate (section <a href="ch-coding2x2.html#sec-contrast-covariate">7.2</a>). One problem in the analysis of interactions occurs in situations where the model is not linear, but has some non-linear link function, for example in logistic models, or when assuming a log-normally distributed dependent variable. In these situations, the model makes predictions for each condition (i.e., design cell) at the latent level of the linear model. Sometimes it is important to translate these model predictions to the level of the observations (e.g., to probabilities in a logistic regression model). We will discuss how this can be implemented in section <a href="ch-coding2x2.html#sec-interactions-NLM">7.3</a>.</p>
<div id="sec-MR-ANOVA" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Contrast coding in a factorial <span class="math inline">\(2 \times 2\)</span> design<a href="ch-coding2x2.html#sec-MR-ANOVA" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In section <a href="ch-contr.html#sec-4levelFactor">6.3</a> of chapter <a href="ch-contr.html#ch-contr">6</a>, we used a data set with one 4-level factor. Here, we assume that the same four means come from an <span class="math inline">\(A(2) \times B(2)\)</span> between-subject-factor design rather than an <span class="math inline">\(F(4)\)</span> between-subject-factor design. Load the simulated data and show summary statistics in Table <a href="ch-coding2x2.html#tab:cTab4Means">7.1</a> and in Figure <a href="ch-coding2x2.html#fig:twobytwosimdatFig">7.1</a>. The means and standard deviations are exactly the same as in Figure <a href="ch-contr.html#fig:helmertsimdatFig">6.2</a> and in Table <a href="ch-contr.html#tab:cTab3Means">6.3</a>.</p>
<div class="figure"><span style="display:block;" id="fig:twobytwosimdatFig"></span>
<img src="bayescogsci_files/figure-html/twobytwosimdatFig-1.svg" alt="Means and error bars (showing standard errors) for a simulated data set with a two-by-two  between-subjects factorial design." width="672" />
<p class="caption">
FIGURE 7.1: Means and error bars (showing standard errors) for a simulated data set with a two-by-two between-subjects factorial design.
</p>
</div>
<table>
<caption><span id="tab:cTab4Means">TABLE 7.1: </span>Summary statistics per condition for the simulated data.</caption>
<thead>
<tr class="header">
<th align="left">Factor A</th>
<th align="left">Factor B</th>
<th align="left">N data</th>
<th align="left">Means</th>
<th align="left">Std. dev.</th>
<th align="left">Std. errors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A1</td>
<td align="left">B1</td>
<td align="left"><span class="math inline">\(5\)</span></td>
<td align="left"><span class="math inline">\(10\)</span></td>
<td align="left"><span class="math inline">\(10\)</span></td>
<td align="left"><span class="math inline">\(4.5\)</span></td>
</tr>
<tr class="even">
<td align="left">A1</td>
<td align="left">B2</td>
<td align="left"><span class="math inline">\(5\)</span></td>
<td align="left"><span class="math inline">\(20\)</span></td>
<td align="left"><span class="math inline">\(10\)</span></td>
<td align="left"><span class="math inline">\(4.5\)</span></td>
</tr>
<tr class="odd">
<td align="left">A2</td>
<td align="left">B1</td>
<td align="left"><span class="math inline">\(5\)</span></td>
<td align="left"><span class="math inline">\(10\)</span></td>
<td align="left"><span class="math inline">\(10\)</span></td>
<td align="left"><span class="math inline">\(4.5\)</span></td>
</tr>
<tr class="even">
<td align="left">A2</td>
<td align="left">B2</td>
<td align="left"><span class="math inline">\(5\)</span></td>
<td align="left"><span class="math inline">\(40\)</span></td>
<td align="left"><span class="math inline">\(10\)</span></td>
<td align="left"><span class="math inline">\(4.5\)</span></td>
</tr>
</tbody>
</table>
<p>In order to carry out a <span class="math inline">\(2\times 2\)</span>  ANOVA-type  (main effects and  interaction) analysis, one needs  sum contrasts in the linear model. (This is true for factors with two levels, but does not generalize to factors with more levels.) The results of such an analysis are shown in Table <a href="ch-coding2x2.html#tab:table18b">7.2</a>. (The analysis immediately below uses sum contrasts: <span class="math inline">\(-1\)</span>/<span class="math inline">\(+1\)</span>; however, scaled sum contrasts <span class="math inline">\(-0.5\)</span>/<span class="math inline">\(+0.5\)</span> could also be used; in this case, the priors would need to be adapted to the respective scale.)</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb418-1"><a href="ch-coding2x2.html#cb418-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>A) &lt;-<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb418-2"><a href="ch-coding2x2.html#cb418-2" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>B) &lt;-<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb419"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb419-1"><a href="ch-coding2x2.html#cb419-1" aria-hidden="true"></a>fit_AB.sum &lt;-<span class="st"> </span><span class="kw">brm</span>(DV <span class="op">~</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B,</span>
<span id="cb419-2"><a href="ch-coding2x2.html#cb419-2" aria-hidden="true"></a>                  <span class="dt">data =</span> df_contrasts4,</span>
<span id="cb419-3"><a href="ch-coding2x2.html#cb419-3" aria-hidden="true"></a>                  <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb419-4"><a href="ch-coding2x2.html#cb419-4" aria-hidden="true"></a>                  <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">20</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb419-5"><a href="ch-coding2x2.html#cb419-5" aria-hidden="true"></a>                            <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb419-6"><a href="ch-coding2x2.html#cb419-6" aria-hidden="true"></a>                            <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<table>
<caption><span id="tab:table18b">TABLE 7.2: </span>Bayesian linear model of a 2 x 2 design with sum contrasts.</caption>
<thead>
<tr class="header">
<th align="left">Predictor</th>
<th align="left">Estimate</th>
<th align="left">Est. Error</th>
<th align="left">2.5%</th>
<th align="left">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="left"><span class="math inline">\(20.05\)</span></td>
<td align="left"><span class="math inline">\(2.44\)</span></td>
<td align="left"><span class="math inline">\(15.22\)</span></td>
<td align="left"><span class="math inline">\(24.93\)</span></td>
</tr>
<tr class="even">
<td align="left">A1</td>
<td align="left"><span class="math inline">\(-5.01\)</span></td>
<td align="left"><span class="math inline">\(2.47\)</span></td>
<td align="left"><span class="math inline">\(-9.99\)</span></td>
<td align="left"><span class="math inline">\(-0.22\)</span></td>
</tr>
<tr class="odd">
<td align="left">B1</td>
<td align="left"><span class="math inline">\(-9.98\)</span></td>
<td align="left"><span class="math inline">\(2.45\)</span></td>
<td align="left"><span class="math inline">\(-14.81\)</span></td>
<td align="left"><span class="math inline">\(-5.11\)</span></td>
</tr>
<tr class="even">
<td align="left">A1:B1</td>
<td align="left"><span class="math inline">\(5.02\)</span></td>
<td align="left"><span class="math inline">\(2.46\)</span></td>
<td align="left"><span class="math inline">\(0.22\)</span></td>
<td align="left"><span class="math inline">\(9.86\)</span></td>
</tr>
</tbody>
</table>
<p>Next, we reproduce the <span class="math inline">\(A(2) \times B(2)\)</span> ANOVA, with contrasts specified for the corresponding one-way <span class="math inline">\(F(4)\)</span> ANOVA; that is, by treating the <span class="math inline">\(2 \times 2 = 4\)</span> condition means as four levels of a single factor <span class="math inline">\(F\)</span>. In other words, we go back to the data frame simulated for the analysis of repeated contrasts (see chapter <a href="ch-contr.html#ch-contr">6</a>, section <a href="ch-contr.html#sec-4levelFactor">6.3</a>). We first define weights for condition means according to our hypotheses, invert this matrix, and use it as the contrast matrix for factor <span class="math inline">\(F\)</span>. We define weights of <span class="math inline">\(1/4\)</span> and <span class="math inline">\(-1/4\)</span>. We do so because (a) we want to compare the mean of two conditions to the mean of two other conditions (e.g., factor <span class="math inline">\(A\)</span> compares <span class="math inline">\(\frac{F1 + F2}{2}\)</span> to <span class="math inline">\(\frac{F3 + F4}{2}\)</span>). Moreover, (b) we want coefficients to code half the difference between condition means, reflecting sum contrasts. Together <span class="math inline">\((a+b)\)</span>, this yields weights of <span class="math inline">\(1/2 \cdot 1/2 = 1/4\)</span>. The resulting contrast matrix contains contrast coefficients of <span class="math inline">\(+1\)</span> or <span class="math inline">\(-1\)</span>, showing that we successfully implemented sum contrasts. The results are identical to the previous models.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb420-1"><a href="ch-coding2x2.html#cb420-1" aria-hidden="true"></a>HcInt &lt;-</span>
<span id="cb420-2"><a href="ch-coding2x2.html#cb420-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">rbind</span>(<span class="dt">A =</span> <span class="kw">c</span>(<span class="dt">F1 =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">F2 =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">F3 =</span> <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">F4 =</span> <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>),</span>
<span id="cb420-3"><a href="ch-coding2x2.html#cb420-3" aria-hidden="true"></a>        <span class="dt">B =</span> <span class="kw">c</span>(<span class="dt">F1 =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">F2 =</span> <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">F3 =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">F4 =</span> <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>),</span>
<span id="cb420-4"><a href="ch-coding2x2.html#cb420-4" aria-hidden="true"></a>        <span class="dt">AxB =</span> <span class="kw">c</span>(<span class="dt">F1 =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">F2 =</span> <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">F3 =</span> <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">F4 =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>))</span>
<span id="cb420-5"><a href="ch-coding2x2.html#cb420-5" aria-hidden="true"></a><span class="kw">t</span>(<span class="kw">fractions</span>(HcInt))</span></code></pre></div>
<pre><code>##    A    B    AxB 
## F1  1/4  1/4  1/4
## F2  1/4 -1/4 -1/4
## F3 -1/4  1/4 -1/4
## F4 -1/4 -1/4  1/4</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb422-1"><a href="ch-coding2x2.html#cb422-1" aria-hidden="true"></a>(XcInt &lt;-<span class="st"> </span><span class="kw">ginv2</span>(HcInt))</span></code></pre></div>
<pre><code>##    A  B  AxB
## F1  1  1  1 
## F2  1 -1 -1 
## F3 -1  1 -1 
## F4 -1 -1  1</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb424-1"><a href="ch-coding2x2.html#cb424-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts3<span class="op">$</span>F) &lt;-<span class="st"> </span>XcInt</span></code></pre></div>
<div class="sourceCode" id="cb425"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb425-1"><a href="ch-coding2x2.html#cb425-1" aria-hidden="true"></a>fit_F4.sum &lt;-<span class="st"> </span><span class="kw">brm</span>(DV <span class="op">~</span><span class="st"> </span>F,</span>
<span id="cb425-2"><a href="ch-coding2x2.html#cb425-2" aria-hidden="true"></a>                  <span class="dt">data =</span> df_contrasts3,</span>
<span id="cb425-3"><a href="ch-coding2x2.html#cb425-3" aria-hidden="true"></a>                  <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb425-4"><a href="ch-coding2x2.html#cb425-4" aria-hidden="true"></a>                  <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">20</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb425-5"><a href="ch-coding2x2.html#cb425-5" aria-hidden="true"></a>                            <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb425-6"><a href="ch-coding2x2.html#cb425-6" aria-hidden="true"></a>                            <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb426"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb426-1"><a href="ch-coding2x2.html#cb426-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_F4.sum)</span></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5 Q97.5
## Intercept    20.04      2.39  15.31 24.80
## FA           -5.01      2.48  -9.81 -0.20
## FB           -9.99      2.42 -14.78 -5.24
## FAxB          4.91      2.51  -0.03  9.73</code></pre>
<p>This shows that it is possible to specify the contrasts not only for each factor (e.g., here in the <span class="math inline">\(2 \times 2\)</span> design) separately. Instead, one can also pool all experimental conditions (or design cells) into one large factor (here factor <span class="math inline">\(F\)</span> with <span class="math inline">\(4\)</span> levels), and specify the contrasts for the main effects and for the interactions in the resulting one large contrast matrix simultaneously.</p>
<p>In this approach, it can again be very useful to apply the  <code>hypr</code> package to construct contrasts for a  <span class="math inline">\(2 \times 2\)</span> design. The first parameter estimates the main effect <span class="math inline">\(A\)</span>, i.e., it compares the average of <span class="math inline">\(F1\)</span> and <span class="math inline">\(F2\)</span> to the average of <span class="math inline">\(F3\)</span> and <span class="math inline">\(F4\)</span>. The second parameter estimates the main effect <span class="math inline">\(B\)</span>, i.e., it compares the average of <span class="math inline">\(F1\)</span> and <span class="math inline">\(F3\)</span> to the average of <span class="math inline">\(F2\)</span> and <span class="math inline">\(F4\)</span>.</p>
<p>We code direct differences between the averages, i.e., we implement scaled sum contrasts instead of sum contrasts. This is shown below: the contrast matrix contains coefficients of <span class="math inline">\(+1/2\)</span> and <span class="math inline">\(-1/2\)</span> instead of <span class="math inline">\(+1\)</span> and <span class="math inline">\(-1\)</span>. The  interaction term estimates the difference between differences, i.e., the difference between <span class="math inline">\(F1 - F2\)</span> and <span class="math inline">\(F3 - F4\)</span>.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb428-1"><a href="ch-coding2x2.html#cb428-1" aria-hidden="true"></a>hAxB &lt;-<span class="st"> </span><span class="kw">hypr</span>(<span class="dt">A =</span> (F1 <span class="op">+</span><span class="st"> </span>F2) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>(F3 <span class="op">+</span><span class="st"> </span>F4) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb428-2"><a href="ch-coding2x2.html#cb428-2" aria-hidden="true"></a>             <span class="dt">B =</span> (F1 <span class="op">+</span><span class="st"> </span>F3) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>(F2 <span class="op">+</span><span class="st"> </span>F4) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb428-3"><a href="ch-coding2x2.html#cb428-3" aria-hidden="true"></a>             <span class="dt">AxB =</span> (F1 <span class="op">-</span><span class="st"> </span>F2) <span class="op">~</span><span class="st"> </span>(F3 <span class="op">-</span><span class="st"> </span>F4))</span>
<span id="cb428-4"><a href="ch-coding2x2.html#cb428-4" aria-hidden="true"></a>hAxB</span></code></pre></div>
<pre><code>## hypr object containing 3 null hypotheses:
##   H0.A: 0 = (F1 + F2 - F3 - F4)/2
##   H0.B: 0 = (F1 + F3 - F2 - F4)/2
## H0.AxB: 0 = F1 - F2 - F3 + F4
## 
## Call:
## hypr(A = ~1/2 * F1 + 1/2 * F2 - 1/2 * F3 - 1/2 * F4, B = ~1/2 * 
##     F1 + 1/2 * F3 - 1/2 * F2 - 1/2 * F4, AxB = ~F1 - F2 - F3 + 
##     F4, levels = c(&quot;F1&quot;, &quot;F2&quot;, &quot;F3&quot;, &quot;F4&quot;))
## 
## Hypothesis matrix (transposed):
##    A    B    AxB 
## F1  1/2  1/2    1
## F2  1/2 -1/2   -1
## F3 -1/2  1/2   -1
## F4 -1/2 -1/2    1
## 
## Contrast matrix:
##    A    B    AxB 
## F1  1/2  1/2  1/4
## F2  1/2 -1/2 -1/4
## F3 -1/2  1/2 -1/4
## F4 -1/2 -1/2  1/4</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb430-1"><a href="ch-coding2x2.html#cb430-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts3<span class="op">$</span>F) &lt;-<span class="st"> </span><span class="kw">contr.hypothesis</span>(hAxB)</span></code></pre></div>
<div class="sourceCode" id="cb431"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb431-1"><a href="ch-coding2x2.html#cb431-1" aria-hidden="true"></a>fit_F4hypr &lt;-<span class="st"> </span><span class="kw">brm</span>(DV <span class="op">~</span><span class="st"> </span>F,</span>
<span id="cb431-2"><a href="ch-coding2x2.html#cb431-2" aria-hidden="true"></a>                  <span class="dt">data =</span> df_contrasts3,</span>
<span id="cb431-3"><a href="ch-coding2x2.html#cb431-3" aria-hidden="true"></a>                  <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb431-4"><a href="ch-coding2x2.html#cb431-4" aria-hidden="true"></a>                  <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">20</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb431-5"><a href="ch-coding2x2.html#cb431-5" aria-hidden="true"></a>                            <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb431-6"><a href="ch-coding2x2.html#cb431-6" aria-hidden="true"></a>                            <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb432"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb432-1"><a href="ch-coding2x2.html#cb432-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_F4hypr)</span></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5  Q97.5
## Intercept    19.96      2.43  15.28  24.82
## FA           -9.89      4.79 -19.60  -0.64
## FB          -19.80      4.98 -29.41 -10.20
## FAxB         19.08      9.57  -0.02  38.39</code></pre>
<p>The results show that the estimates for the main effects have (approximately) double the size as compared to the <span class="math inline">\(\pm 1\)</span> sum contrasts–this is the result of the scaling that we applied. I.e., the main effects now directly estimate the difference between averages. The interaction estimates the difference between differences. Importantly, if we change the scaling of the contrasts, we also need to adapt the scaling of the priors. If appropriate priors are used, then both contrasts would lead to the same hypothesis tests if one were doing hypothesis testing using Bayes factors. Thus, the <code>hypr</code> package can be used to code hypotheses in a <span class="math inline">\(2 \times 2\)</span> design.</p>
<p>Now the main effects and interaction can be directly interpreted as differences between averages and as differences between differences. If one wants the interaction term to be on the same scale as the main effects, it would need to be multiplied by 2; however, then its interpretation would not be straightforward any more (i.e., it is no longer “the difference between differences” but a scaled variant of this). Thus, putting the interaction on the same scale as the main effects has the advantage that it ensures that the prior has the same scaling across the different terms. However, it has the disadvantage that the interpretation of the interaction term is not straightforward.</p>
<p>Incidentally, an alternative way to code main effects and interactions is to use the <code>ifelse()</code> command in R. For example, if we want to use <span class="math inline">\(\pm 1/2\)</span> sum contrasts as in the above example, we can specify the contrasts for the main effects as vectors:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb434-1"><a href="ch-coding2x2.html#cb434-1" aria-hidden="true"></a>A &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df_contrasts3<span class="op">$</span>F <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;F1&quot;</span>, <span class="st">&quot;F2&quot;</span>), <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb434-2"><a href="ch-coding2x2.html#cb434-2" aria-hidden="true"></a>B &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df_contrasts3<span class="op">$</span>F <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;F1&quot;</span>, <span class="st">&quot;F3&quot;</span>), <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<p>Now, defining the interaction is simply a matter of multiplying the two vectors:</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb435-1"><a href="ch-coding2x2.html#cb435-1" aria-hidden="true"></a>AxB &lt;-<span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B</span></code></pre></div>
<div class="sourceCode" id="cb436"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb436-1"><a href="ch-coding2x2.html#cb436-1" aria-hidden="true"></a><span class="co">## rescale:</span></span>
<span id="cb436-2"><a href="ch-coding2x2.html#cb436-2" aria-hidden="true"></a>(AxB &lt;-<span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>##  [1]  0.5  0.5  0.5  0.5  0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5
## [14] -0.5 -0.5  0.5  0.5  0.5  0.5  0.5</code></pre>
<p>This kind of vector-based contrast coding is convenient for more complex designs, such as <span class="math inline">\(2\times 2\times 2\)</span> factorial designs. However, in such complex designs, the <code>ifelse()</code> command can become cumbersome, so a better approach is to use the <code>merge()</code> function in R, as shown below.</p>
<p>First, define a data frame that represents the main effects and interaction contrasts for the four conditions.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb438-1"><a href="ch-coding2x2.html#cb438-1" aria-hidden="true"></a>(contr_coding &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;F1&quot;</span>, <span class="st">&quot;F2&quot;</span>, <span class="st">&quot;F3&quot;</span>, <span class="st">&quot;F4&quot;</span>),</span>
<span id="cb438-2"><a href="ch-coding2x2.html#cb438-2" aria-hidden="true"></a>                            <span class="dt">A =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb438-3"><a href="ch-coding2x2.html#cb438-3" aria-hidden="true"></a>                            <span class="dt">B =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb438-4"><a href="ch-coding2x2.html#cb438-4" aria-hidden="true"></a>                            <span class="dt">AxB =</span> <span class="kw">c</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>##   Condition    A    B  AxB
## 1        F1 -0.5 -0.5  0.5
## 2        F2 -0.5  0.5 -0.5
## 3        F3  0.5 -0.5 -0.5
## 4        F4  0.5  0.5  0.5</code></pre>
<p>Then, one can merge this data frame with the data frame that contains the data:</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb440-1"><a href="ch-coding2x2.html#cb440-1" aria-hidden="true"></a>(df_contrasts3 &lt;-<span class="st"> </span><span class="kw">merge</span>(df_contrasts3,</span>
<span id="cb440-2"><a href="ch-coding2x2.html#cb440-2" aria-hidden="true"></a>                        contr_coding,</span>
<span id="cb440-3"><a href="ch-coding2x2.html#cb440-3" aria-hidden="true"></a>                        <span class="dt">by.x =</span> <span class="st">&quot;F&quot;</span>,</span>
<span id="cb440-4"><a href="ch-coding2x2.html#cb440-4" aria-hidden="true"></a>                        <span class="dt">by.y =</span> <span class="st">&quot;Condition&quot;</span>))</span></code></pre></div>
<pre><code>##     F     DV id Fc2vs1 Fc3vs2 Fc4vs3    A    B  AxB
## 1  F1 17.547  1  -0.75   -0.5  -0.25 -0.5 -0.5  0.5
## 2  F1 -6.683  2  -0.75   -0.5  -0.25 -0.5 -0.5  0.5
## 3  F1 10.574  3  -0.75   -0.5  -0.25 -0.5 -0.5  0.5
## 4  F1 10.558  4  -0.75   -0.5  -0.25 -0.5 -0.5  0.5
## 5  F1 18.005  5  -0.75   -0.5  -0.25 -0.5 -0.5  0.5
## 6  F2 20.123  6   0.25   -0.5  -0.25 -0.5  0.5 -0.5
## 7  F2 14.773  7   0.25   -0.5  -0.25 -0.5  0.5 -0.5
## 8  F2 22.613  8   0.25   -0.5  -0.25 -0.5  0.5 -0.5
## 9  F2 34.713  9   0.25   -0.5  -0.25 -0.5  0.5 -0.5
## 10 F2  7.778 10   0.25   -0.5  -0.25 -0.5  0.5 -0.5
## 11 F3 18.936 11   0.25    0.5  -0.25  0.5 -0.5 -0.5
## 12 F3  9.518 12   0.25    0.5  -0.25  0.5 -0.5 -0.5
## 13 F3 21.227 13   0.25    0.5  -0.25  0.5 -0.5 -0.5
## 14 F3 -0.153 14   0.25    0.5  -0.25  0.5 -0.5 -0.5
## 15 F3  0.472 15   0.25    0.5  -0.25  0.5 -0.5 -0.5
## 16 F4 26.466 16   0.25    0.5   0.75  0.5  0.5  0.5
## 17 F4 36.243 17   0.25    0.5   0.75  0.5  0.5  0.5
## 18 F4 53.667 18   0.25    0.5   0.75  0.5  0.5  0.5
## 19 F4 39.651 19   0.25    0.5   0.75  0.5  0.5  0.5
## 20 F4 43.973 20   0.25    0.5   0.75  0.5  0.5  0.5</code></pre>
<div id="nestedEffects" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span>  Nested effects<a href="ch-coding2x2.html#nestedEffects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One can estimate effects that do not correspond directly to main effects and interaction of the traditional ANOVA. For example, in a <span class="math inline">\(2 \times 2\)</span> experimental design, where factor <span class="math inline">\(A\)</span> codes word frequency (low/high) and factor <span class="math inline">\(B\)</span> is part of speech (noun/verb), one can estimate the effect of word frequency within nouns and the effect of word frequency within verbs. Formally, <span class="math inline">\(A_{B1}\)</span> versus <span class="math inline">\(A_{B2}\)</span> are nested within levels of <span class="math inline">\(B\)</span>. Said differently,  simple effects of factor <span class="math inline">\(A\)</span> are estimated for each of the levels of factor <span class="math inline">\(B\)</span>.
In this version, we estimate the main effect of part of speech (<span class="math inline">\(B\)</span>; as in traditional ANOVA). Instead of also estimating the second main effect word frequency, <span class="math inline">\(A\)</span>, and the interaction, we estimate (1) the differences between the two levels of word frequency <span class="math inline">\(A\)</span> in the first level of <span class="math inline">\(B\)</span> (i.e., nouns), and (2) the difference between the two levels of word frequency <span class="math inline">\(A\)</span> in the second level of <span class="math inline">\(B\)</span> (i.e., verbs). In other words, we estimate the differences between the two levels of <span class="math inline">\(A\)</span> in each of the levels of <span class="math inline">\(B\)</span>. Often, researchers have hypotheses about these differences, and not about the interaction.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb442-1"><a href="ch-coding2x2.html#cb442-1" aria-hidden="true"></a>HcNes &lt;-</span>
<span id="cb442-2"><a href="ch-coding2x2.html#cb442-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">rbind</span>(<span class="dt">B =</span> <span class="kw">c</span>(<span class="dt">F1 =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">F2 =</span> <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">F3 =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">F4 =</span> <span class="dv">-1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb442-3"><a href="ch-coding2x2.html#cb442-3" aria-hidden="true"></a>        <span class="dt">B1xA =</span> <span class="kw">c</span>(<span class="dt">F1 =</span> <span class="dv">-1</span>, <span class="dt">F2 =</span> <span class="dv">0</span>, <span class="dt">F3 =</span> <span class="dv">1</span>, <span class="dt">F4 =</span> <span class="dv">0</span>),</span>
<span id="cb442-4"><a href="ch-coding2x2.html#cb442-4" aria-hidden="true"></a>        <span class="dt">B2xA =</span> <span class="kw">c</span>(<span class="dt">F1 =</span> <span class="dv">0</span>, <span class="dt">F2 =</span> <span class="dv">-1</span>, <span class="dt">F3 =</span> <span class="dv">0</span>, <span class="dt">F4 =</span> <span class="dv">1</span>))</span>
<span id="cb442-5"><a href="ch-coding2x2.html#cb442-5" aria-hidden="true"></a><span class="kw">t</span>(<span class="kw">fractions</span>(HcNes))</span></code></pre></div>
<pre><code>##    B    B1xA B2xA
## F1  1/2   -1    0
## F2 -1/2    0   -1
## F3  1/2    1    0
## F4 -1/2    0    1</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb444-1"><a href="ch-coding2x2.html#cb444-1" aria-hidden="true"></a>(XcNes &lt;-<span class="st"> </span><span class="kw">ginv2</span>(HcNes))</span></code></pre></div>
<pre><code>##    B    B1xA B2xA
## F1  1/2 -1/2    0
## F2 -1/2    0 -1/2
## F3  1/2  1/2    0
## F4 -1/2    0  1/2</code></pre>
<div class="sourceCode" id="cb446"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb446-1"><a href="ch-coding2x2.html#cb446-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts3<span class="op">$</span>F) &lt;-<span class="st"> </span>XcNes</span></code></pre></div>
<div class="sourceCode" id="cb447"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb447-1"><a href="ch-coding2x2.html#cb447-1" aria-hidden="true"></a>fit_Nest &lt;-<span class="st"> </span><span class="kw">brm</span>(DV <span class="op">~</span><span class="st"> </span>F,</span>
<span id="cb447-2"><a href="ch-coding2x2.html#cb447-2" aria-hidden="true"></a>                <span class="dt">data =</span> df_contrasts3,</span>
<span id="cb447-3"><a href="ch-coding2x2.html#cb447-3" aria-hidden="true"></a>                <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb447-4"><a href="ch-coding2x2.html#cb447-4" aria-hidden="true"></a>                <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">20</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb447-5"><a href="ch-coding2x2.html#cb447-5" aria-hidden="true"></a>                          <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb447-6"><a href="ch-coding2x2.html#cb447-6" aria-hidden="true"></a>                          <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb448"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb448-1"><a href="ch-coding2x2.html#cb448-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_Nest)</span></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5 Q97.5
## Intercept    20.07      2.38  15.46  24.9
## FB          -19.80      4.94 -29.73 -10.0
## FB1xA        -0.09      7.07 -13.97  14.0
## FB2xA        19.80      6.85   5.99  33.0</code></pre>
<p>The regression coefficients estimate the  grand mean, the difference for the  main effect of part of speech (<span class="math inline">\(B\)</span>) and the two differences (for <span class="math inline">\(A\)</span>; i.e., simple main effects) within the two levels (noun and verb) of part of speech (<span class="math inline">\(B\)</span>).</p>
<p>These  custom nested contrasts’ columns are scaled versions of the corresponding  hypothesis matrix. This is the case because the columns are orthogonal. This illustrates one advantage of  orthogonal contrasts for the interpretation of regression coefficients: the underlying comparisons being estimated are already clear from the contrast matrix.</p>
<p>There is also a built-in R formula specification for nested designs. The order of factors in the formula from left to right specifies a top-down order of nesting within levels, i.e., here factor <span class="math inline">\(A\)</span> (word frequency) is nested within levels of the factor <span class="math inline">\(B\)</span> (part of speech). This yields the same result as our previous result based on custom nested contrasts:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb450-1"><a href="ch-coding2x2.html#cb450-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>A) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">+0.5</span>)</span>
<span id="cb450-2"><a href="ch-coding2x2.html#cb450-2" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>B) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">+</span><span class="fl">0.5</span>, <span class="fl">-0.5</span>)</span>
<span id="cb450-3"><a href="ch-coding2x2.html#cb450-3" aria-hidden="true"></a>fit_Nest2 &lt;-<span class="st"> </span><span class="kw">brm</span>(DV <span class="op">~</span><span class="st"> </span>B <span class="op">/</span><span class="st"> </span>A,</span>
<span id="cb450-4"><a href="ch-coding2x2.html#cb450-4" aria-hidden="true"></a>                 <span class="dt">data =</span> df_contrasts4,</span>
<span id="cb450-5"><a href="ch-coding2x2.html#cb450-5" aria-hidden="true"></a>                 <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb450-6"><a href="ch-coding2x2.html#cb450-6" aria-hidden="true"></a>                 <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">20</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb450-7"><a href="ch-coding2x2.html#cb450-7" aria-hidden="true"></a>                           <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb450-8"><a href="ch-coding2x2.html#cb450-8" aria-hidden="true"></a>                           <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb451"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb451-1"><a href="ch-coding2x2.html#cb451-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_Nest2)</span></code></pre></div>
<pre><code>##           Estimate Est.Error  Q2.5 Q97.5
## Intercept    20.02      2.54  14.8 24.93
## B1          -19.86      4.99 -29.5 -9.98
## BB1:A1        0.01      7.34 -14.6 14.61
## BB2:A1       19.49      7.10   5.3 33.18</code></pre>
<p>In cases such as these, where <span class="math inline">\(A_{B1}\)</span> vs. <span class="math inline">\(A_{B2}\)</span> are nested within levels of <span class="math inline">\(B\)</span>, it is necessary to include the effect of <span class="math inline">\(B\)</span> (part of speech) in the model, even if one is only interested in the effect of <span class="math inline">\(A\)</span> (word frequency) within levels of <span class="math inline">\(B\)</span> (part of speech). Leaving out factor <span class="math inline">\(B\)</span> in this particular case of a between-subjects deisn would increase posterior uncertainty if the data are fully balanced, and could lead to biases in parameter estimation if the data are not fully balanced.</p>
<p>Again, we show how nested contrasts can be easily implemented using  <code>hypr</code>:</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb453-1"><a href="ch-coding2x2.html#cb453-1" aria-hidden="true"></a>hNest &lt;-<span class="st"> </span><span class="kw">hypr</span>(<span class="dt">B =</span> (F1 <span class="op">+</span><span class="st"> </span>F3) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>(F2 <span class="op">+</span><span class="st"> </span>F4) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb453-2"><a href="ch-coding2x2.html#cb453-2" aria-hidden="true"></a>              <span class="dt">B1xA =</span> F3 <span class="op">~</span><span class="st"> </span>F1,</span>
<span id="cb453-3"><a href="ch-coding2x2.html#cb453-3" aria-hidden="true"></a>              <span class="dt">B2xA =</span> F4 <span class="op">~</span><span class="st"> </span>F2)</span>
<span id="cb453-4"><a href="ch-coding2x2.html#cb453-4" aria-hidden="true"></a>hNest</span></code></pre></div>
<pre><code>## hypr object containing 3 null hypotheses:
##    H0.B: 0 = (F1 + F3 - F2 - F4)/2
## H0.B1xA: 0 = F3 - F1
## H0.B2xA: 0 = F4 - F2
## 
## Call:
## hypr(B = ~1/2 * F1 + 1/2 * F3 - 1/2 * F2 - 1/2 * F4, B1xA = ~F3 - 
##     F1, B2xA = ~F4 - F2, levels = c(&quot;F1&quot;, &quot;F2&quot;, &quot;F3&quot;, &quot;F4&quot;))
## 
## Hypothesis matrix (transposed):
##    B    B1xA B2xA
## F1  1/2   -1    0
## F2 -1/2    0   -1
## F3  1/2    1    0
## F4 -1/2    0    1
## 
## Contrast matrix:
##    B    B1xA B2xA
## F1  1/2 -1/2    0
## F2 -1/2    0 -1/2
## F3  1/2  1/2    0
## F4 -1/2    0  1/2</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb455-1"><a href="ch-coding2x2.html#cb455-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts3<span class="op">$</span>F) &lt;-<span class="st"> </span><span class="kw">contr.hypothesis</span>(hNest)</span></code></pre></div>
<div class="sourceCode" id="cb456"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb456-1"><a href="ch-coding2x2.html#cb456-1" aria-hidden="true"></a>fit_NestHypr &lt;-</span>
<span id="cb456-2"><a href="ch-coding2x2.html#cb456-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">brm</span>(DV <span class="op">~</span><span class="st"> </span>F,</span>
<span id="cb456-3"><a href="ch-coding2x2.html#cb456-3" aria-hidden="true"></a>      <span class="dt">data =</span> df_contrasts3,</span>
<span id="cb456-4"><a href="ch-coding2x2.html#cb456-4" aria-hidden="true"></a>      <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb456-5"><a href="ch-coding2x2.html#cb456-5" aria-hidden="true"></a>      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">20</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb456-6"><a href="ch-coding2x2.html#cb456-6" aria-hidden="true"></a>                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb456-7"><a href="ch-coding2x2.html#cb456-7" aria-hidden="true"></a>                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb457"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb457-1"><a href="ch-coding2x2.html#cb457-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_NestHypr)</span></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5 Q97.5
## Intercept     20.0      2.47  15.00  24.9
## FB           -19.9      4.79 -29.10 -10.2
## FB1xA         -0.2      6.86 -13.84  13.6
## FB2xA         19.4      6.97   5.11  33.0</code></pre>
<p>Of course, we can also ask the reverse question: Are there differences for part of speech (<span class="math inline">\(B\)</span>) in the levels of word frequency (<span class="math inline">\(A\)</span>; in addition to estimating the main effect of word frequency, <span class="math inline">\(A\)</span>)? That is, do nouns differ from verbs for low-frequency words (<span class="math inline">\(B_{A1}\)</span>) and do nouns differ from verbs for high-frequency words (<span class="math inline">\(B_{A2}\)</span>)?</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb459-1"><a href="ch-coding2x2.html#cb459-1" aria-hidden="true"></a>hNest2 &lt;-<span class="st"> </span><span class="kw">hypr</span>(<span class="dt">A =</span> (F1 <span class="op">+</span><span class="st"> </span>F2) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>(F3 <span class="op">+</span><span class="st"> </span>F4) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb459-2"><a href="ch-coding2x2.html#cb459-2" aria-hidden="true"></a>               <span class="dt">A1xB =</span> F2 <span class="op">~</span><span class="st"> </span>F1,</span>
<span id="cb459-3"><a href="ch-coding2x2.html#cb459-3" aria-hidden="true"></a>               <span class="dt">A2xB =</span> F4 <span class="op">~</span><span class="st"> </span>F3)</span>
<span id="cb459-4"><a href="ch-coding2x2.html#cb459-4" aria-hidden="true"></a>hNest2</span></code></pre></div>
<pre><code>## hypr object containing 3 null hypotheses:
##    H0.A: 0 = (F1 + F2 - F3 - F4)/2
## H0.A1xB: 0 = F2 - F1
## H0.A2xB: 0 = F4 - F3
## 
## Call:
## hypr(A = ~1/2 * F1 + 1/2 * F2 - 1/2 * F3 - 1/2 * F4, A1xB = ~F2 - 
##     F1, A2xB = ~F4 - F3, levels = c(&quot;F1&quot;, &quot;F2&quot;, &quot;F3&quot;, &quot;F4&quot;))
## 
## Hypothesis matrix (transposed):
##    A    A1xB A2xB
## F1  1/2   -1    0
## F2  1/2    1    0
## F3 -1/2    0   -1
## F4 -1/2    0    1
## 
## Contrast matrix:
##    A    A1xB A2xB
## F1  1/2 -1/2    0
## F2  1/2  1/2    0
## F3 -1/2    0 -1/2
## F4 -1/2    0  1/2</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb461-1"><a href="ch-coding2x2.html#cb461-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts3<span class="op">$</span>F) &lt;-<span class="st"> </span><span class="kw">contr.hypothesis</span>(hNest2)</span></code></pre></div>
<div class="sourceCode" id="cb462"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb462-1"><a href="ch-coding2x2.html#cb462-1" aria-hidden="true"></a>fit_Nest2Hypr &lt;-</span>
<span id="cb462-2"><a href="ch-coding2x2.html#cb462-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">brm</span>(DV <span class="op">~</span><span class="st"> </span>F,</span>
<span id="cb462-3"><a href="ch-coding2x2.html#cb462-3" aria-hidden="true"></a>      <span class="dt">data =</span> df_contrasts3,</span>
<span id="cb462-4"><a href="ch-coding2x2.html#cb462-4" aria-hidden="true"></a>      <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb462-5"><a href="ch-coding2x2.html#cb462-5" aria-hidden="true"></a>      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">20</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb462-6"><a href="ch-coding2x2.html#cb462-6" aria-hidden="true"></a>                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb462-7"><a href="ch-coding2x2.html#cb462-7" aria-hidden="true"></a>                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb463"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb463-1"><a href="ch-coding2x2.html#cb463-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_Nest2Hypr)</span></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5 Q97.5
## Intercept    20.03      2.43  15.10 25.00
## FA           -9.92      4.90 -19.25 -0.12
## FA1xB         9.73      6.90  -4.14 23.07
## FA2xB        29.62      6.81  16.23 43.13</code></pre>
<p>Regression coefficients estimate the  grand mean, the difference for the  main effect of word frequency (<span class="math inline">\(A\)</span>) and the two part of speech effects (for <span class="math inline">\(B\)</span>; i.e.,  simple main effects) within levels of word frequency (<span class="math inline">\(A\)</span>).</p>
<p>An important issue to keep in mind is that if, using nested contrasts, one finds a large effect in one nested comparison (e.g., <code>FA2xB</code>) but no difference or a smaller effect in the other comparison (here, <code>FA1xB</code>), one cannot conclude that there is an interaction; to argue for an interaction, one would have to test for the main effects and interaction using the ANOVA contrast coding <span class="citation">(Nieuwenhuis, Forstmann, and Wagenmakers <a href="#ref-nieuwenhuis2011erroneous" role="doc-biblioref">2011</a>)</span>.</p>
</div>
<div id="interactions-between-contrasts" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span>  Interactions between contrasts<a href="ch-coding2x2.html#interactions-between-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a <span class="math inline">\(2 \times 2\)</span> experimental design, the results from sum contrasts are equivalent to typical ANOVA results that we see in frequentist analyses. This means that sum contrasts assess the main effects and the interactions. One interesting question that arises here is: what would happen in a  <span class="math inline">\(2 \times 2\)</span> design if we had used  treatment contrasts instead of sum contrasts? Is it still possible to meaningfully interpret the results from the treatment contrasts in a simple <span class="math inline">\(2 \times 2\)</span> design?</p>
<p>This leads us to a very important principle in interpreting results from contrasts: When interactions between contrasts are included in a model, then the results for one contrast actually depend on the specification of the other contrast(s) in the analysis! This may be counter-intuitive at first, but it is very important and essential to keep in mind when interpreting results from contrasts. How does this work in detail?</p>
<p>The general rule to remember is that the effect of one contrast measures its effect at the location <span class="math inline">\(0\)</span> of the other contrast(s) in the analysis. This can be seen in the regression equation of a <span class="math inline">\(2 \times 2\)</span> design with factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>:</p>
<p><span class="math display">\[\begin{equation}
E[Y] = \alpha + \beta_A A + \beta_B B + \beta_{A \times B} A \times B
\end{equation}\]</span></p>
<p>If we set the predictor <span class="math inline">\(B\)</span> to zero, then the equation simplifies to:</p>
<p><span class="math display">\[\begin{equation}
E[Y] = \alpha + \beta_A A
\end{equation}\]</span></p>
<p>Thus, now we can see the “pure” effect of <span class="math inline">\(A\)</span>.</p>
<p>What does that mean practically? Let us consider the example that we use two treatment contrasts in a <span class="math inline">\(2 \times 2\)</span> design. Here are the results from the linear model</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb465-1"><a href="ch-coding2x2.html#cb465-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>A) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb465-2"><a href="ch-coding2x2.html#cb465-2" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>B) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb465-3"><a href="ch-coding2x2.html#cb465-3" aria-hidden="true"></a>fit_treatm &lt;-<span class="st"> </span><span class="kw">brm</span>(DV <span class="op">~</span><span class="st"> </span>B <span class="op">*</span><span class="st"> </span>A,</span>
<span id="cb465-4"><a href="ch-coding2x2.html#cb465-4" aria-hidden="true"></a>                  <span class="dt">data =</span> df_contrasts4,</span>
<span id="cb465-5"><a href="ch-coding2x2.html#cb465-5" aria-hidden="true"></a>                  <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb465-6"><a href="ch-coding2x2.html#cb465-6" aria-hidden="true"></a>                  <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">20</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb465-7"><a href="ch-coding2x2.html#cb465-7" aria-hidden="true"></a>                            <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb465-8"><a href="ch-coding2x2.html#cb465-8" aria-hidden="true"></a>                            <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb466"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb466-1"><a href="ch-coding2x2.html#cb466-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_treatm)</span></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5 Q97.5
## Intercept     10.1      4.83   0.42  19.7
## B1            10.0      6.77  -3.22  23.3
## A1             0.0      6.63 -13.18  13.6
## B1:A1         19.8      9.34   1.03  38.5</code></pre>
<p>Let’s take a look at the effect of factor <span class="math inline">\(A\)</span>. How can we interpret what this measures? This effect actually estimates the effect of factor <span class="math inline">\(A\)</span> at the “location” where factor <span class="math inline">\(B\)</span> is coded as <span class="math inline">\(0\)</span>. Factor <span class="math inline">\(B\)</span> is coded as a treatment contrast, that is, it codes a zero at its baseline condition, which is <span class="math inline">\(B1\)</span>. Thus, the effect of factor <span class="math inline">\(A\)</span> estimates the effect of <span class="math inline">\(A\)</span> nested within the baseline condition of <span class="math inline">\(B\)</span>, i.e., a  simple effect. We take a look at the data presented in Figure <a href="ch-coding2x2.html#fig:twobytwosimdatFig">7.1</a>, what this  nested effect should be. Figure <a href="ch-coding2x2.html#fig:twobytwosimdatFig">7.1</a> shows that the effect of factor <span class="math inline">\(A\)</span> nested in <span class="math inline">\(B1\)</span> is <span class="math inline">\(0\)</span>. If we now compare this to the results from the linear model, it is indeed clear that the effect of factor <span class="math inline">\(A\)</span> is exactly estimated as <span class="math inline">\(0\)</span>. As expected, when factor <span class="math inline">\(B\)</span> is coded as a treatment contrast, the effect of factor <span class="math inline">\(A\)</span> estimates the effect of <span class="math inline">\(A\)</span> nested within the baseline level of factor <span class="math inline">\(B\)</span>.</p>
<p>Next, consider the effect of factor <span class="math inline">\(B\)</span>. According to the same logic, this effect estimates the effect of factor <span class="math inline">\(B\)</span> at the “location” where factor <span class="math inline">\(A\)</span> is <span class="math inline">\(0\)</span>. Factor <span class="math inline">\(A\)</span> is also coded as a treatment contrast, that is, it codes its baseline condition <span class="math inline">\(A1\)</span> as <span class="math inline">\(0\)</span>. The effect of factor <span class="math inline">\(B\)</span> estimates the effect of <span class="math inline">\(B\)</span> nested within the baseline condition of <span class="math inline">\(A\)</span>. Figure <a href="ch-coding2x2.html#fig:twobytwosimdatFig">7.1</a> shows that this effect should be <span class="math inline">\(10\)</span>.</p>
<p>How do we know what the “location” is, where a contrast applies? For the treatment contrasts discussed here, it is possible to reason this through because all contrasts are coded as <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>. How can one derive the “location” in general? What we can do is to look at the comparisons that are estimated when using the treatment contrasts (or in case we use Bayes factors, which  hypotheses are tested) in the presence of an interaction between them by using the  generalized matrix inverse. We go back to the default treatment contrasts. Then we extract the contrast matrix from the design matrix:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb468-1"><a href="ch-coding2x2.html#cb468-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>A) &lt;-<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb468-2"><a href="ch-coding2x2.html#cb468-2" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>B) &lt;-<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb468-3"><a href="ch-coding2x2.html#cb468-3" aria-hidden="true"></a>XcTr &lt;-<span class="st"> </span>df_contrasts4 <span class="op">%&gt;%</span></span>
<span id="cb468-4"><a href="ch-coding2x2.html#cb468-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(A, B) <span class="op">%&gt;%</span></span>
<span id="cb468-5"><a href="ch-coding2x2.html#cb468-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>() <span class="op">%&gt;%</span></span>
<span id="cb468-6"><a href="ch-coding2x2.html#cb468-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B, .) <span class="op">%&gt;%</span></span>
<span id="cb468-7"><a href="ch-coding2x2.html#cb468-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb468-8"><a href="ch-coding2x2.html#cb468-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">as.matrix</span>()</span>
<span id="cb468-9"><a href="ch-coding2x2.html#cb468-9" aria-hidden="true"></a><span class="kw">rownames</span>(XcTr) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A1_B1&quot;</span>, <span class="st">&quot;A1_B2&quot;</span>, <span class="st">&quot;A2_B1&quot;</span>, <span class="st">&quot;A2_B2&quot;</span>)</span>
<span id="cb468-10"><a href="ch-coding2x2.html#cb468-10" aria-hidden="true"></a>XcTr</span></code></pre></div>
<pre><code>##       (Intercept) A2 B2 A2:B2
## A1_B1           1  0  0     0
## A1_B2           1  0  1     0
## A2_B1           1  1  0     0
## A2_B2           1  1  1     1</code></pre>
<p>This shows the treatment contrast for factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, and their interaction. We can now assign this  contrast matrix to a  <code>hypr</code> object. <code>hypr</code> automatically converts the contrast matrix into a  hypothesis matrix, such that we can read from the hypothesis matrix which comparison are being estimated by the different contrasts.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb470-1"><a href="ch-coding2x2.html#cb470-1" aria-hidden="true"></a>htr &lt;-<span class="st"> </span><span class="kw">hypr</span>() <span class="co"># initialize empty hypr object</span></span>
<span id="cb470-2"><a href="ch-coding2x2.html#cb470-2" aria-hidden="true"></a><span class="kw">cmat</span>(htr) &lt;-<span class="st"> </span>XcTr <span class="co"># assign contrast matrix to hypr object</span></span>
<span id="cb470-3"><a href="ch-coding2x2.html#cb470-3" aria-hidden="true"></a>htr <span class="co"># look at the resulting hypothesis matrix</span></span></code></pre></div>
<pre><code>## hypr object containing 4 null hypotheses:
## H0.(Intercept): 0 = A1_B1                          (Intercept)
##          H0.A2: 0 = -A1_B1 + A2_B1
##          H0.B2: 0 = -A1_B1 + A1_B2
##       H0.A2:B2: 0 = A1_B1 - A1_B2 - A2_B1 + A2_B2
## 
## Call:
## hypr(`(Intercept)` = ~A1_B1, A2 = ~-A1_B1 + A2_B1, B2 = ~-A1_B1 + 
##     A1_B2, `A2:B2` = ~A1_B1 - A1_B2 - A2_B1 + A2_B2, levels = c(&quot;A1_B1&quot;, 
## &quot;A1_B2&quot;, &quot;A2_B1&quot;, &quot;A2_B2&quot;))
## 
## Hypothesis matrix (transposed):
##       (Intercept) A2 B2 A2:B2
## A1_B1  1          -1 -1  1   
## A1_B2  0           0  1 -1   
## A2_B1  0           1  0 -1   
## A2_B2  0           0  0  1   
## 
## Contrast matrix:
##       (Intercept) A2 B2 A2:B2
## A1_B1 1           0  0  0    
## A1_B2 1           0  1  0    
## A2_B1 1           1  0  0    
## A2_B2 1           1  1  1</code></pre>
<p>The same result is obtained by applying the generalized inverse to the contrast matrix (this is what <code>hypr()</code> does as well). An important fact is that when we apply the generalized inverse to the contrast matrix, we obtain the corresponding hypothesis matrix <span class="citation">(for details, see Schad et al. <a href="#ref-schadHowCapitalizePriori2020" role="doc-biblioref">2020</a>)</span>.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb472-1"><a href="ch-coding2x2.html#cb472-1" aria-hidden="true"></a><span class="kw">t</span>(<span class="kw">ginv2</span>(XcTr))</span></code></pre></div>
<pre><code>##       (Intercept) A2 B2 A2:B2
## A1_B1  1          -1 -1  1   
## A1_B2  0           0  1 -1   
## A2_B1  0           1  0 -1   
## A2_B2  0           0  0  1</code></pre>
<p>As discussed above, the effect of factor <span class="math inline">\(A\)</span> estimates its effect nested within the baseline level of factor <span class="math inline">\(B\)</span>. Likewise, the effect of factor <span class="math inline">\(B\)</span> estimates its effect nested within the baseline level of factor <span class="math inline">\(A\)</span>. The term <span class="math inline">\(A:B\)</span> always tests the interaction between both factors, irrespective of the centering of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<p>How does this work for  sum contrasts? They do not have a baseline condition that is coded as <span class="math inline">\(0\)</span>. In sum contrasts, the average of the contrast coefficients is <span class="math inline">\(0\)</span>. Therefore, effects estimate the average effect across factor levels, i.e., they estimate a  main effect. This is what is typically also tested in standard  ANOVA. Let’s look at the example shown in Table <a href="ch-coding2x2.html#tab:table18b">7.2</a>: given that factor <span class="math inline">\(B\)</span> has a sum contrast, the main effect of factor <span class="math inline">\(A\)</span> is estimated as the average across levels of factor <span class="math inline">\(B\)</span>. Figure <a href="ch-coding2x2.html#fig:twobytwosimdatFig">7.1</a> shows that the effect of factor <span class="math inline">\(A\)</span> in level B1 is <span class="math inline">\(10 - 10 = 0\)</span>, and in level <span class="math inline">\(B2\)</span> it is <span class="math inline">\(20 - 40 = -20\)</span>. The average effect across both levels is <span class="math inline">\((0 - 20)/2 = -10\)</span>. Due to the sum contrast coding, we have to divide this by two, yielding an expected effect of <span class="math inline">\(-10 / 2 = -5\)</span>. This is exactly what the effect of factor <span class="math inline">\(A\)</span> measures (see Table <a href="ch-coding2x2.html#tab:table18b">7.2</a>, <em>Estimate</em> for <span class="math inline">\(A1\)</span>).</p>
<p>Similarly, factor <span class="math inline">\(B\)</span> estimates its effect at the location <span class="math inline">\(0\)</span> of factor <span class="math inline">\(A\)</span>. Again, <span class="math inline">\(0\)</span> is exactly the mean of the contrast coefficients from factor <span class="math inline">\(A\)</span>, which is coded as a sum contrast. Therefore, factor <span class="math inline">\(B\)</span> estimates the effect of <span class="math inline">\(B\)</span> averaged across factor levels of <span class="math inline">\(A\)</span>, i.e., the main effect of <span class="math inline">\(B\)</span>. For factor level <span class="math inline">\(A1\)</span>, factor <span class="math inline">\(B\)</span> has an effect of <span class="math inline">\(10 - 20 = -10\)</span>. For factor level <span class="math inline">\(A2\)</span>, factor <span class="math inline">\(B\)</span> has an effect of <span class="math inline">\(10 - 40 = -30\)</span>. The average effect is <span class="math inline">\((-10 - 30)/2 = -20\)</span>, which again needs to be divided by <span class="math inline">\(2\)</span> due to the sum contrast. This yields exactly the estimate of <span class="math inline">\(-10\)</span> that is also reported in Table <a href="ch-coding2x2.html#tab:table18b">7.2</a> (<em>Estimate</em> for B1).</p>
<p>Again, we look at the hypothesis matrix for the main effects and the interaction:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb474-1"><a href="ch-coding2x2.html#cb474-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>A) &lt;-<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb474-2"><a href="ch-coding2x2.html#cb474-2" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts4<span class="op">$</span>B) &lt;-<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)</span>
<span id="cb474-3"><a href="ch-coding2x2.html#cb474-3" aria-hidden="true"></a>XcSum &lt;-<span class="st"> </span>df_contrasts4 <span class="op">%&gt;%</span></span>
<span id="cb474-4"><a href="ch-coding2x2.html#cb474-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(A, B) <span class="op">%&gt;%</span></span>
<span id="cb474-5"><a href="ch-coding2x2.html#cb474-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>() <span class="op">%&gt;%</span></span>
<span id="cb474-6"><a href="ch-coding2x2.html#cb474-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B, .) <span class="op">%&gt;%</span></span>
<span id="cb474-7"><a href="ch-coding2x2.html#cb474-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb474-8"><a href="ch-coding2x2.html#cb474-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">as.matrix</span>()</span>
<span id="cb474-9"><a href="ch-coding2x2.html#cb474-9" aria-hidden="true"></a><span class="kw">rownames</span>(XcSum) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A1_B1&quot;</span>, <span class="st">&quot;A1_B2&quot;</span>, <span class="st">&quot;A2_B1&quot;</span>, <span class="st">&quot;A2_B2&quot;</span>)</span>
<span id="cb474-10"><a href="ch-coding2x2.html#cb474-10" aria-hidden="true"></a></span>
<span id="cb474-11"><a href="ch-coding2x2.html#cb474-11" aria-hidden="true"></a>hsum &lt;-<span class="st"> </span><span class="kw">hypr</span>() <span class="co"># initialize empty hypr object</span></span>
<span id="cb474-12"><a href="ch-coding2x2.html#cb474-12" aria-hidden="true"></a><span class="kw">cmat</span>(hsum) &lt;-<span class="st"> </span>XcSum <span class="co"># assign contrast matrix to hypr object</span></span>
<span id="cb474-13"><a href="ch-coding2x2.html#cb474-13" aria-hidden="true"></a>hsum <span class="co"># look at the resulting hypothesis matrix</span></span></code></pre></div>
<pre><code>## hypr object containing 4 null hypotheses:
## H0.(Intercept): 0 = (A1_B1 + A1_B2 + A2_B1 + A2_B2)/4  (Intercept)
##          H0.A1: 0 = (A1_B1 + A1_B2 - A2_B1 - A2_B2)/4
##          H0.B1: 0 = (A1_B1 - A1_B2 + A2_B1 - A2_B2)/4
##       H0.A1:B1: 0 = (A1_B1 - A1_B2 - A2_B1 + A2_B2)/4
## 
## Call:
## hypr(`(Intercept)` = ~1/4 * A1_B1 + 1/4 * A1_B2 + 1/4 * A2_B1 + 
##     1/4 * A2_B2, A1 = ~1/4 * A1_B1 + 1/4 * A1_B2 - 1/4 * A2_B1 - 
##     1/4 * A2_B2, B1 = ~1/4 * A1_B1 - 1/4 * A1_B2 + 1/4 * A2_B1 - 
##     1/4 * A2_B2, `A1:B1` = ~1/4 * A1_B1 - 1/4 * A1_B2 - 1/4 * 
##     A2_B1 + 1/4 * A2_B2, levels = c(&quot;A1_B1&quot;, &quot;A1_B2&quot;, &quot;A2_B1&quot;, 
## &quot;A2_B2&quot;))
## 
## Hypothesis matrix (transposed):
##       (Intercept) A1   B1   A1:B1
## A1_B1  1/4         1/4  1/4  1/4 
## A1_B2  1/4         1/4 -1/4 -1/4 
## A2_B1  1/4        -1/4  1/4 -1/4 
## A2_B2  1/4        -1/4 -1/4  1/4 
## 
## Contrast matrix:
##       (Intercept) A1 B1 A1:B1
## A1_B1  1           1  1  1   
## A1_B2  1           1 -1 -1   
## A2_B1  1          -1  1 -1   
## A2_B2  1          -1 -1  1</code></pre>
<p>This shows that each of the effects now does not compute nested comparisons any more, but that they rather estimate their effect averaged across conditions of the other factor. The averaging involves using weights of <span class="math inline">\(1/2\)</span> in the hypothesis matrix. Moreover, the regression coefficients in the sum contrast measure half the distance between conditions, leading to weights of <span class="math inline">\(1/2 \cdot 1/2 = 1/4\)</span> in the hypothesis matrix.</p>
<p>The general rule to remember from these examples is that when  interactions between contrasts are estimated, what an effect of a factor estimates depends on the contrast coding of the other factors in the design! The effect of a factor estimates the effect nested within the location zero of the other contrast(s) in an analysis. If another contrast is centered, and zero is the average of this other contrasts’ coefficients, then the contrast of interest estimates the average or  main effect, averaged across the levels of the other factor. Importantly, this property, that the coding of the other factor determines the estimates of one factor, holds only when the interaction between two contrasts is included into a model. If the interaction is omitted and only effects are estimated, then there is no such influence.</p>
<p>This may be a very surprising result for interactions of contrasts. However, it is also essential to interpreting contrast coefficients involved in interactions. It is particularly relevant for the analysis of the default treatment contrast, where the main effects estimate  nested effects rather than average effects.</p>
</div>
</div>
<div id="sec-contrast-covariate" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> One factor and one  covariate<a href="ch-coding2x2.html#sec-contrast-covariate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="estimating-a-group-difference-and-controlling-for-a-covariate" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Estimating a  group difference and controlling for a covariate<a href="ch-coding2x2.html#estimating-a-group-difference-and-controlling-for-a-covariate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section we treat the case where there are again two predictor variables for one dependent variable, but where one predictor variable is a discrete factor, and the other is a continuous covariate. Let’s assume we have measured some response time (RT), e.g., in a lexical decision task. We want to predict the response time based on each subject’s IQ, and we expect that higher IQ leads to shorter response times. Moreover, we have two groups of each 30 subjects. These are coded as factor <span class="math inline">\(F\)</span>, with factor levels <span class="math inline">\(F1\)</span> and <span class="math inline">\(F2\)</span>. We assume that these two groups have obtained different training programs to optimize their response times on the task. Group <span class="math inline">\(F1\)</span> obtained a control training, whereas group <span class="math inline">\(F2\)</span> obtained training to improve lexical decisions. We want to estimate the extent to which the training for better lexical decisions in group <span class="math inline">\(F2\)</span> leads to shorter response times compared to the control group <span class="math inline">\(F1\)</span>. This is our main question of interest here, i.e., the extent to which the training program in <span class="math inline">\(F2\)</span> leads to faster response times compared to the control group <span class="math inline">\(F1\)</span>. We load the data, which is a simulated data set.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb476-1"><a href="ch-coding2x2.html#cb476-1" aria-hidden="true"></a><span class="kw">data</span>(<span class="st">&quot;df_contrasts5&quot;</span>)</span></code></pre></div>
<p>Our main effect of interest is the factor <span class="math inline">\(F\)</span>. We want to estimate its effect on response times and code it using scaled sum contrasts, such that negative parameter estimates would yield support for our hypothesis that response times are faster in the training group <span class="math inline">\(F2\)</span>:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb477-1"><a href="ch-coding2x2.html#cb477-1" aria-hidden="true"></a>(<span class="kw">contrasts</span>(df_contrasts5<span class="op">$</span>F) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">+0.5</span>))</span></code></pre></div>
<pre><code>## [1] -0.5  0.5</code></pre>
<p>We run a <code>brms</code> model to estimate the effect of factor <span class="math inline">\(F\)</span>, i.e., how strongly the response times in the two groups differ from each other.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb479-1"><a href="ch-coding2x2.html#cb479-1" aria-hidden="true"></a>fit_RT_F &lt;-<span class="st"> </span><span class="kw">brm</span>(RT <span class="op">~</span><span class="st"> </span>F,</span>
<span id="cb479-2"><a href="ch-coding2x2.html#cb479-2" aria-hidden="true"></a>                <span class="dt">data =</span> df_contrasts5,</span>
<span id="cb479-3"><a href="ch-coding2x2.html#cb479-3" aria-hidden="true"></a>                <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb479-4"><a href="ch-coding2x2.html#cb479-4" aria-hidden="true"></a>                <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">200</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb479-5"><a href="ch-coding2x2.html#cb479-5" aria-hidden="true"></a>                          <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb479-6"><a href="ch-coding2x2.html#cb479-6" aria-hidden="true"></a>                          <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb480"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb480-1"><a href="ch-coding2x2.html#cb480-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_RT_F)</span></code></pre></div>
<pre><code>##           Estimate Est.Error Q2.5  Q97.5
## Intercept    212.2      5.19  202 222.00
## F1           -24.3     10.53  -45  -3.54</code></pre>

<div class="figure"><span style="display:block;" id="fig:figRTF"></span>
<img src="bayescogsci_files/figure-html/figRTF-1.svg" alt="Means and error bars (showing standard errors) for a simulated data set of response times for two different groups of subjects, who have obtained a training in lexical decisions (\(F2\)) versus have obtained a control training (\(F1\))." width="240" />
<p class="caption">
FIGURE 7.2: Means and error bars (showing standard errors) for a simulated data set of response times for two different groups of subjects, who have obtained a training in lexical decisions (<span class="math inline">\(F2\)</span>) versus have obtained a control training (<span class="math inline">\(F1\)</span>).
</p>
</div>
<p>We find (see model estimates and data shown in Figure <a href="ch-coding2x2.html#fig:figRTF">7.2</a>) that response times in group <span class="math inline">\(F2\)</span> are roughly <span class="math inline">\(25\)</span> ms faster than in group <span class="math inline">\(F1\)</span> (Estimate of <span class="math inline">\(-24\)</span>). This suggests that as expected, the training program that group <span class="math inline">\(F2\)</span> obtained seems to be successful in speeding up response times. Recall that one cannot just look at the 95% credible interval and check whether zero is outside the interval to declare that we have found an effect. To make a discovery claim, we need to run a Bayes factor analysis on this data set to directly test this hypothesis, and this may or may not provide evidence for a difference in response times between groups.</p>
<p>Let’s assume we have allocated subjects to the two groups randomly. Let’s say that we also measured the IQ of each person using an IQ test. We did so because we expected that IQ could have an influence on response times, and we wanted to control for this influence. We now can check whether the two groups had the same average IQ.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb482-1"><a href="ch-coding2x2.html#cb482-1" aria-hidden="true"></a>df_contrasts5 <span class="op">%&gt;%</span></span>
<span id="cb482-2"><a href="ch-coding2x2.html#cb482-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(F) <span class="op">%&gt;%</span></span>
<span id="cb482-3"><a href="ch-coding2x2.html#cb482-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">M.IQ =</span> <span class="kw">mean</span>(IQ))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   F      M.IQ
##   &lt;fct&gt; &lt;dbl&gt;
## 1 F1       85
## 2 F2      115</code></pre>
<p>Group <span class="math inline">\(F2\)</span> not only obtained additional training and had faster response times, group <span class="math inline">\(F2\)</span> also had a higher IQ (mean of 115) on average than group <span class="math inline">\(F1\)</span> (mean IQ = 85). Thus, the random allocation of subjects to the two groups seems to have created–by chance–a difference in IQs. Now we can ask the question: why might response times in group <span class="math inline">\(F2\)</span> be faster than in group <span class="math inline">\(F1\)</span>? Is this because of the training program in <span class="math inline">\(F2\)</span>? Or is this simply because the average IQ in group <span class="math inline">\(F2\)</span> was higher than in group <span class="math inline">\(F1\)</span>? To investigate this question, we add both predictor variables simultaneously in a <code>brms</code> model. Before we enter the continuous IQ variable, we center it, by subtracting its mean. Centering covariates is generally good practice. Moreover, it is often important to  <span class="math inline">\(z\)</span>-transform the covariate, i.e., to not only subtract the mean, but also to divide by its standard deviation (this can be done as follows: <code>df_contrasts5$IQ.s &lt;- scale(df_contrasts5$IQ)</code>). The reason why this is often important is that the sampler doesn’t work well if predictors have different scales. For the simple models we use here, the sampler works without <span class="math inline">\(z\)</span>-transformation. However, for more realistic and more complex models, <span class="math inline">\(z\)</span>-transformation of covariates is often very important. Importantly, when changing the scale of the predictor, then the scale of the prior has to be changed accordingly. Here, we set the same priors for the contrast and for the covariate IQ for convenience. In realistic models, these priors have to be set separately.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb484-1"><a href="ch-coding2x2.html#cb484-1" aria-hidden="true"></a>df_contrasts5 &lt;-<span class="st"> </span>df_contrasts5 <span class="op">%&gt;%</span></span>
<span id="cb484-2"><a href="ch-coding2x2.html#cb484-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">c_IQ =</span> IQ <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(IQ))</span>
<span id="cb484-3"><a href="ch-coding2x2.html#cb484-3" aria-hidden="true"></a>fit_RT_F_IQ &lt;-<span class="st"> </span><span class="kw">brm</span>(RT <span class="op">~</span><span class="st"> </span>F <span class="op">+</span><span class="st"> </span>c_IQ,</span>
<span id="cb484-4"><a href="ch-coding2x2.html#cb484-4" aria-hidden="true"></a>                   <span class="dt">data =</span> df_contrasts5,</span>
<span id="cb484-5"><a href="ch-coding2x2.html#cb484-5" aria-hidden="true"></a>                   <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb484-6"><a href="ch-coding2x2.html#cb484-6" aria-hidden="true"></a>                   <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">200</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb484-7"><a href="ch-coding2x2.html#cb484-7" aria-hidden="true"></a>                             <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb484-8"><a href="ch-coding2x2.html#cb484-8" aria-hidden="true"></a>                             <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb485"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb485-1"><a href="ch-coding2x2.html#cb485-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_RT_F_IQ)</span></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5  Q97.5
## Intercept   212.28      4.86 202.64 221.71
## F1            6.26     13.15 -19.56  31.43
## c_IQ         -1.05      0.32  -1.68  -0.41</code></pre>
<p>The results from the <code>brms</code> model now show that the difference in response times between groups (i.e., factor <span class="math inline">\(F\)</span>) is not estimated to be <span class="math inline">\(-25\)</span> ms any more, but instead, the estimate is about <span class="math inline">\(+7\)</span> ms, and the 95% credible interval spans the range <span class="math inline">\(-20\)</span> to <span class="math inline">\(33\)</span>. Thus, there doesn’t seem to be much reason to believe any more that the groups would differ. At the same time, we see that the predictor variable IQ shows a negative effect (Estimate = <span class="math inline">\(-1\)</span> with 95% credible interval: <span class="math inline">\(-1.7\)</span> to <span class="math inline">\(-0.4\)</span>), suggesting that–as expected–response times seem to be faster in subjects with higher IQ.</p>

<div class="figure"><span style="display:block;" id="fig:figRTFIQ"></span>
<img src="bayescogsci_files/figure-html/figRTFIQ-1.svg" alt="Response times as a function of individual IQ for two groups with a lexical decision training (\(F2\)) versus a control training (\(F1\)). Points indicate individual subjects, and lines with error bands indicate linear regression lines." width="672" />
<p class="caption">
FIGURE 7.3: Response times as a function of individual IQ for two groups with a lexical decision training (<span class="math inline">\(F2\)</span>) versus a control training (<span class="math inline">\(F1\)</span>). Points indicate individual subjects, and lines with error bands indicate linear regression lines.
</p>
</div>
<p>This result can also be seen in Figure <a href="ch-coding2x2.html#fig:figRTFIQ">7.3</a>, which shows that response times decrease with increasing IQ, as suggested by the <code>brms</code> model. However, the heights of the two  regression lines do not differ from each other, consistent with the observation in the <code>brms</code> model that the effect of factor <span class="math inline">\(F\)</span> did not seem to differ from zero. That is, factor <span class="math inline">\(F\)</span> in the <code>brms</code> model estimates the difference in height of the regression line between both groups.
That the height does not differ and the effect of <span class="math inline">\(F\)</span> is estimated to be close to zero suggests that in fact group <span class="math inline">\(F2\)</span> showed faster response times not because of their additional training program. Instead, they had faster response times simply because their IQ was by chance higher on average compared to the control group <span class="math inline">\(F1\)</span>. This analysis is the Bayesian equivalence of the frequentist  “analysis of covariance” (ANCOVA), where it’s possible to estimate a group difference after “controlling for” the influence of a covariate.</p>
<p>We can also see in Figure <a href="ch-coding2x2.html#fig:figRTFIQ">7.3</a> that the two regression lines for the two groups are exactly parallel to each other. That is, the influence of IQ on response times seems to be exactly the same in both groups. This is actually an assumption in the ANCOVA analysis that needs to be checked in the data. That is, if we want to estimate the difference between groups after controlling for a covariate (here IQ), we have to investigate whether the influence of the covariate is the same in both groups. We can estimate this by including an  interaction term between the factor and the covariate in the <code>brms</code> model:</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb487-1"><a href="ch-coding2x2.html#cb487-1" aria-hidden="true"></a>fit_RT_FxIQ &lt;-</span>
<span id="cb487-2"><a href="ch-coding2x2.html#cb487-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">brm</span>(RT <span class="op">~</span><span class="st"> </span>F <span class="op">*</span><span class="st"> </span>c_IQ,</span>
<span id="cb487-3"><a href="ch-coding2x2.html#cb487-3" aria-hidden="true"></a>      <span class="dt">data =</span> df_contrasts5,</span>
<span id="cb487-4"><a href="ch-coding2x2.html#cb487-4" aria-hidden="true"></a>      <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb487-5"><a href="ch-coding2x2.html#cb487-5" aria-hidden="true"></a>      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">200</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb487-6"><a href="ch-coding2x2.html#cb487-6" aria-hidden="true"></a>                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb487-7"><a href="ch-coding2x2.html#cb487-7" aria-hidden="true"></a>                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb488"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb488-1"><a href="ch-coding2x2.html#cb488-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_RT_FxIQ)</span></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5  Q97.5
## Intercept   212.49      7.06 198.51 226.20
## F1            6.70     14.26 -20.23  35.58
## c_IQ         -1.06      0.34  -1.71  -0.39
## F1:c_IQ      -0.01      0.67  -1.31   1.29</code></pre>
<p>The estimate for the interaction (the term <code>F1:c_IQ</code>) is very small here (close to <span class="math inline">\(0\)</span>) and the 95% credible intervals clearly overlap with zero, showing that the two regression lines are estimated to be very similar, or parallel, to each other. If this is the case, then it is possible to correct for IQ when estimating the group difference. (From the perspective of causal inference, one might need additional requirements to draw strong conclusions here, such as measuring the covariate before the dependent variable, or reasoning based on theoretical plausibility.)</p>
</div>
<div id="estimating-differences-in-slopes" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Estimating differences in slopes<a href="ch-coding2x2.html#estimating-differences-in-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We now take a look at a different data set.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb490-1"><a href="ch-coding2x2.html#cb490-1" aria-hidden="true"></a><span class="kw">data</span>(<span class="st">&quot;df_contrasts6&quot;</span>)</span>
<span id="cb490-2"><a href="ch-coding2x2.html#cb490-2" aria-hidden="true"></a><span class="kw">levels</span>(df_contrasts6<span class="op">$</span>F) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;simple&quot;</span>, <span class="st">&quot;complex&quot;</span>)</span></code></pre></div>
<p>This again contains data from response times (RT) in two groups. Let’s assume the two groups have performed two different response time tasks, where one simple RT task doesn’t rely on much cognitive processing (group “simple”), whereas the other task is more complex and depends on complex cognitive operations (group “complex”). We therefore expect that RTs in the simple task should be independent of IQ, whereas in the complex task, individuals with a high IQ should be faster in responding compared to individuals with low IQ. Thus, our primary hypothesis of interest states that the influence of IQ on RT differs between conditions. This means that we are interested in the difference between slopes. A slope in a linear regression assesses how strongly the dependent variable (here RT) changes with an increase of one unit on the covariate (here IQ), it thus assesses how “steep” the regression line is. Our hypothesis thus states that the  regression lines differ between groups.</p>
<div class="figure"><span style="display:block;" id="fig:figRTFxIQ"></span>
<img src="bayescogsci_files/figure-html/figRTFxIQ-1.svg" alt="Response times as a function of individual IQ for two groups performing a simple versus a complex task. Points indicate individual subjects' responses, and lines with error bands show the fitted linear regression lines." width="672" />
<p class="caption">
FIGURE 7.4: Response times as a function of individual IQ for two groups performing a simple versus a complex task. Points indicate individual subjects’ responses, and lines with error bands show the fitted linear regression lines.
</p>
</div>
<p>The results, displayed in Figure <a href="ch-coding2x2.html#fig:figRTFxIQ">7.4</a>, suggest that the data seem to support our hypothesis. For the subjects performing the complex task, response times seem to decrease with increasing IQ, whereas for subjects performing the simple task, response times seem to be independent of IQ. As stated before, our primary hypothesis relates to the difference in slopes. Statistically speaking, this is assessed in the  interaction between the factor and the covariate. Thus, we run a <code>brms</code> model where the interaction is included. Importantly, we first use scaled  sum contrasts for the group effect, and again center the  covariate IQ.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb491-1"><a href="ch-coding2x2.html#cb491-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts6<span class="op">$</span>F) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">+0.5</span>)</span>
<span id="cb491-2"><a href="ch-coding2x2.html#cb491-2" aria-hidden="true"></a>df_contrasts6<span class="op">$</span>c_IQ &lt;-<span class="st"> </span>df_contrasts6<span class="op">$</span>IQ <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(df_contrasts6<span class="op">$</span>IQ)</span>
<span id="cb491-3"><a href="ch-coding2x2.html#cb491-3" aria-hidden="true"></a>fit_RT_FxIQ2 &lt;-<span class="st"> </span><span class="kw">brm</span>(RT <span class="op">~</span><span class="st">  </span>F <span class="op">*</span><span class="st"> </span>c_IQ,</span>
<span id="cb491-4"><a href="ch-coding2x2.html#cb491-4" aria-hidden="true"></a>                    <span class="dt">data =</span> df_contrasts6,</span>
<span id="cb491-5"><a href="ch-coding2x2.html#cb491-5" aria-hidden="true"></a>                    <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb491-6"><a href="ch-coding2x2.html#cb491-6" aria-hidden="true"></a>                    <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">200</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb491-7"><a href="ch-coding2x2.html#cb491-7" aria-hidden="true"></a>                              <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb491-8"><a href="ch-coding2x2.html#cb491-8" aria-hidden="true"></a>                              <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb492"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb492-1"><a href="ch-coding2x2.html#cb492-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_RT_FxIQ2)</span></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5  Q97.5
## Intercept   209.97      4.90 200.23 219.68
## F1           19.18      9.62   0.38  38.00
## c_IQ         -0.80      0.33  -1.44  -0.19
## F1:c_IQ      -1.61      0.64  -2.87  -0.36</code></pre>
<p>We can see that the main effect of IQ (term <code>c_IQ</code>) is negative (<span class="math inline">\(-0.8\)</span>) with 95% credible intervals <span class="math inline">\(-1.5\)</span> to <span class="math inline">\(-0.2\)</span>, suggesting that overall response times decrease with increasing IQ. This is qualified by the interaction term, which is estimated to be negative (<span class="math inline">\(-1.6\)</span>), with 95% credible intervals <span class="math inline">\(-2.9\)</span> to <span class="math inline">\(-0.3\)</span>. This suggests that the slope in the complex group (which was coded as <span class="math inline">\(+0.5\)</span> in the scaled sum contrast) is more negative than the slope in the simple group (which was coded as <span class="math inline">\(-0.5\)</span> in the scaled sum contrast). Thus, the interaction assesses the difference between slopes.</p>
<p>We can also run a model, where the  nested slopes are estimated, i.e., the slope of IQ in the simple group and the slope of IQ in the complex group. This can be implemented by using the nested coding that we learned about in the previous section:</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb494-1"><a href="ch-coding2x2.html#cb494-1" aria-hidden="true"></a>fit_RT_FnIQ2 &lt;-</span>
<span id="cb494-2"><a href="ch-coding2x2.html#cb494-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">brm</span>(RT <span class="op">~</span><span class="st"> </span>F <span class="op">/</span><span class="st"> </span>c_IQ,</span>
<span id="cb494-3"><a href="ch-coding2x2.html#cb494-3" aria-hidden="true"></a>      <span class="dt">data =</span> df_contrasts6,</span>
<span id="cb494-4"><a href="ch-coding2x2.html#cb494-4" aria-hidden="true"></a>      <span class="dt">family =</span> <span class="kw">gaussian</span>(),</span>
<span id="cb494-5"><a href="ch-coding2x2.html#cb494-5" aria-hidden="true"></a>      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">200</span>, <span class="dv">50</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb494-6"><a href="ch-coding2x2.html#cb494-6" aria-hidden="true"></a>                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> sigma),</span>
<span id="cb494-7"><a href="ch-coding2x2.html#cb494-7" aria-hidden="true"></a>                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb495"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb495-1"><a href="ch-coding2x2.html#cb495-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_RT_FnIQ2)</span></code></pre></div>
<pre><code>##               Estimate Est.Error   Q2.5  Q97.5
## Intercept        209.9      4.79 200.26 219.37
## F1                19.3      9.46   0.29  37.23
## Fsimple:c_IQ       0.0      0.47  -0.94   0.93
## Fcomplex:c_IQ     -1.6      0.46  -2.51  -0.69</code></pre>
<p>Now we see that the slope of IQ in the simple group (<code>Fsimple:c_IQ</code>) is estimated to be <span class="math inline">\(0\)</span>, with credible intervals clearly including zero. By contrast, the slope in the complex group (<code>Fcomplex:c_IQ</code>) is estimated as <span class="math inline">\(-1.6\)</span> (95% CrI = <span class="math inline">\([-2.5,-0.7]\)</span>). This is consistent with our hypothesis that high IQ speeds up response times for the complex but not for the simple task. (To obtain evidence for this effect, we need Bayes factors, see chapter <a href="ch-bf.html#ch-bf">13</a>.)
We can also see from the  nested analysis that the difference in slopes between conditions is <span class="math inline">\(-1.6 - 0.0 = -1.6\)</span>. This is exactly the value for the interaction term that we estimated in the previous model, demonstrating that  interaction terms assess the difference between slopes; i.e., they estimate in how far the regression lines in the two conditions are parallel, with an estimate of <span class="math inline">\(0\)</span> indicating perfectly parallel lines.</p>
<p>Notice that we can compute posterior samples for the nested slopes from the model with the interaction. That is, we can take the model that estimates main effects and the interaction, and compute posterior samples for the slope of IQ in the simple task and the slope of IQ in the complex task. First, we extract the posterior samples from the model.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb497-1"><a href="ch-coding2x2.html#cb497-1" aria-hidden="true"></a>df_postSamp_RT_FxIQ2 &lt;-<span class="st"> </span><span class="kw">as_draws_df</span>(fit_RT_FxIQ2)</span></code></pre></div>
<p>Then, we take a look at the contrast coefficients for the group factor:</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb498-1"><a href="ch-coding2x2.html#cb498-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts6<span class="op">$</span>F)</span></code></pre></div>
<pre><code>##         [,1]
## simple  -0.5
## complex  0.5</code></pre>
<p>They show a value of <span class="math inline">\(-0.5\)</span> for the simple group. Thus, to compute the slope for the simple group we have to take the overall slope for <code>c_IQ</code> and subtract <span class="math inline">\(-0.5\)</span> times the estimate for the interaction:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb500-1"><a href="ch-coding2x2.html#cb500-1" aria-hidden="true"></a>df_postSamp_RT_FxIQ2 &lt;-<span class="st"> </span>df_postSamp_RT_FxIQ2 <span class="op">%&gt;%</span></span>
<span id="cb500-2"><a href="ch-coding2x2.html#cb500-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">b_c_IQ_simple =</span> b_c_IQ <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> `</span><span class="dt">b_F1:c_IQ</span><span class="st">`</span>)</span></code></pre></div>
<p>Likewise, to estimate the slope for the complex group we have to take the overall slope for <code>c_IQ</code> and add <span class="math inline">\(+0.5\)</span> times the estimate for the interaction:</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb501-1"><a href="ch-coding2x2.html#cb501-1" aria-hidden="true"></a>df_postSamp_RT_FxIQ2 &lt;-<span class="st"> </span>df_postSamp_RT_FxIQ2 <span class="op">%&gt;%</span></span>
<span id="cb501-2"><a href="ch-coding2x2.html#cb501-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">b_c_IQ_complex =</span> b_c_IQ <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> `</span><span class="dt">b_F1:c_IQ</span><span class="st">`</span>)</span></code></pre></div>
<div class="sourceCode" id="cb502"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb502-1"><a href="ch-coding2x2.html#cb502-1" aria-hidden="true"></a><span class="kw">c</span>(<span class="dt">IQc.c_simple =</span> <span class="kw">mean</span>(df_postSamp_RT_FxIQ2<span class="op">$</span>b_c_IQ_simple),</span>
<span id="cb502-2"><a href="ch-coding2x2.html#cb502-2" aria-hidden="true"></a>  <span class="dt">IQc.c_complex =</span> <span class="kw">mean</span>(df_postSamp_RT_FxIQ2<span class="op">$</span>b_c_IQ_complex))</span></code></pre></div>
<pre><code>##  IQc.c_simple IQc.c_complex 
##       0.00738      -1.60730</code></pre>
<p>The results show that the posterior means for the slope of <code>c_IQ</code> are <span class="math inline">\(0\)</span> and <span class="math inline">\(-1.6\)</span> for the simple and the complex groups, as we had found above in the nested analysis. This is the case because the data are sufficiently informative compared to the data. When the data are sparse or when working with Bayes factors, priors will have to be set carefully for each specific analysis.</p>
<p>In most situations one should always center  covariates before including them into a model. If covariates are not centered, then the effects (here the effect for the factor) cannot be interpreted as main effects any more.</p>
<p>One can also do analyses with  interactions between a  covariate and a factor, but by using different contrast codings. For example, if we use  treatment contrasts for the factor, then the main effect of <code>c_IQ</code> assesses not the average slope of <code>c_IQ</code> across conditions, but instead the  nested slope of <code>c_IQ</code> within the baseline group of the treatment contrast. The interaction still assesses the difference in slopes between groups. In a situation where there are more than two groups, when one estimates the interaction of contrasts with a covariate, then the contrasts define which slopes are compared with each other in the interaction terms. For example, when using sum contrasts in an example where the influence of IQ is measured on response times for nouns, verbs, and adjectives, then there are two interaction terms: these assess (1) whether the slope of IQ for nouns is different from the average slope across conditions, and (2) whether the slope of IQ for verbs is different from the average slope across conditions. If one uses repeated contrasts in a situation where the influence of IQ on response times is estimated for word frequency conditions “low”, “medium-low”m “medium-high”m and “high”, then there are three interaction terms (one for each contrast). The first interaction term estimates the difference in slopes between “low” and “medium-low” word frequencies, the second interaction term estimates the difference in slopes between “medium-low” and “medium-high” word frequencies, and the third interaction term estimates the difference in slopes between “medium-high” and “high” word frequency conditions. Thus, the logic of how contrasts specify certain comparisons between conditions extends directly to the situation where differences in slopes are estimated.</p>
</div>
</div>
<div id="sec-interactions-NLM" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Interactions in generalized linear models (with non-linear link functions) and non-linear models<a href="ch-coding2x2.html#sec-interactions-NLM" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next, we look at  generalized linear models, where a linear predictor is passed through a non-linear  link function to predict the dependent variable. Examples of generalized linear models include  logistic regression models and models assuming a Poisson distribution. Even though a log-normal model is a linear model on a log-transformed dependent variable, the same techniques apply to this type of model since the logarithm transform is not linear. Here, we treat an example with a logistic model in a <span class="math inline">\(2 \times 2\)</span> factorial between-subject design. The logistic model has the following non-linear link function called the  logistic function: <span class="math inline">\(P(y = 1 \mid \eta) = \frac{1}{1 + \exp(-\eta)}\)</span>, where <span class="math inline">\(\eta\)</span> is the latent linear predictor. For example, in our <span class="math inline">\(2 \times 2\)</span> factorial design with main effects A and B and their interaction, <span class="math inline">\(\eta\)</span> is computed as a linear combination of the intercept plus the main effects and their interaction: <span class="math inline">\(\eta = 1 + \beta_A x_A + \beta_B x_B + \beta_{A \times B} x_{A \times B}\)</span>.</p>
<p>Thus, there is a latent level of linear predictions (<span class="math inline">\(\eta\)</span>), which are then passed through a non-linear link function to predict the probability that the observed data is a success (<span class="math inline">\(P(y = 1)\)</span>). We will use this logistic model to analyze an example data set where the dependent variable is dichotomous, coded as either a <span class="math inline">\(1\)</span> (indicating success) or a <span class="math inline">\(0\)</span> (indicating failure).</p>
<p>We load a simulated data set where the dependent variable codes whether a subject performed a task successfully (<span class="math inline">\(pDV = 1\)</span>) or not (<span class="math inline">\(pDV = 0\)</span>). Moreover, the data set has two between-subject factors A and B. The means for each of the four conditions are shown in Table <a href="ch-coding2x2.html#tab:cTab7Means">7.3</a>.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb504-1"><a href="ch-coding2x2.html#cb504-1" aria-hidden="true"></a><span class="kw">data</span>(<span class="st">&quot;df_contrasts7&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:cTab7Means">TABLE 7.3: </span>Summary statistics per condition for the simulated data.</caption>
<thead>
<tr class="header">
<th align="left">Factor A</th>
<th align="left">Factor B</th>
<th align="left">N data</th>
<th align="left">Means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A1</td>
<td align="left">B1</td>
<td align="left"><span class="math inline">\(50\)</span></td>
<td align="left"><span class="math inline">\(0.2\)</span></td>
</tr>
<tr class="even">
<td align="left">A1</td>
<td align="left">B2</td>
<td align="left"><span class="math inline">\(50\)</span></td>
<td align="left"><span class="math inline">\(0.5\)</span></td>
</tr>
<tr class="odd">
<td align="left">A2</td>
<td align="left">B1</td>
<td align="left"><span class="math inline">\(50\)</span></td>
<td align="left"><span class="math inline">\(0.2\)</span></td>
</tr>
<tr class="even">
<td align="left">A2</td>
<td align="left">B2</td>
<td align="left"><span class="math inline">\(50\)</span></td>
<td align="left"><span class="math inline">\(0.8\)</span></td>
</tr>
</tbody>
</table>
<p>To analyze this data, we use scaled  sum contrasts, as we had done above for the  <span class="math inline">\(2 \times 2\)</span> design with response times as the dependent variable; this allows us to interpret the coefficients directly as  main effects. Next, we fit a <code>brms</code> model. The model specification is the same as the model with response times–with two differences: First, the  <code>family</code> argument is now specified as   <code>family = bernoulli(link = "logit")</code> to indicate the logistic model. We do not specify a prior for <code>sigma</code>, since there is no residual standard deviation in a logistic model.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb505-1"><a href="ch-coding2x2.html#cb505-1" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts7<span class="op">$</span>A) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">+0.5</span>)</span>
<span id="cb505-2"><a href="ch-coding2x2.html#cb505-2" aria-hidden="true"></a><span class="kw">contrasts</span>(df_contrasts7<span class="op">$</span>B) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">+0.5</span>)</span>
<span id="cb505-3"><a href="ch-coding2x2.html#cb505-3" aria-hidden="true"></a>fit_pDV_AB.sum &lt;-<span class="st"> </span><span class="kw">brm</span>(pDV <span class="op">~</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B,</span>
<span id="cb505-4"><a href="ch-coding2x2.html#cb505-4" aria-hidden="true"></a>                      <span class="dt">data =</span> df_contrasts7,</span>
<span id="cb505-5"><a href="ch-coding2x2.html#cb505-5" aria-hidden="true"></a>                      <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb505-6"><a href="ch-coding2x2.html#cb505-6" aria-hidden="true"></a>                      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb505-7"><a href="ch-coding2x2.html#cb505-7" aria-hidden="true"></a>                                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dt">class =</span> b)))</span></code></pre></div>
<div class="sourceCode" id="cb506"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb506-1"><a href="ch-coding2x2.html#cb506-1" aria-hidden="true"></a><span class="kw">fixef</span>(fit_pDV_AB.sum)</span></code></pre></div>
<pre><code>##           Estimate Est.Error  Q2.5 Q97.5
## Intercept    -0.36      0.17 -0.70 -0.03
## A1            0.70      0.34  0.04  1.40
## B1            2.10      0.34  1.46  2.78
## A1:B1         1.34      0.65  0.05  2.63</code></pre>
<p>The results from this analysis show that the estimates for the two main effects (<span class="math inline">\(A1\)</span> and <span class="math inline">\(B1\)</span>) as well as the interaction (<span class="math inline">\(A1:B1\)</span>) are positive and the 95% credible intervals do not include zero. If we want to make a discovery claim, we would need to perform Bayes factor analyses to investigate the evidence that there is for each of the effects.</p>
<p>Next, we discuss how we can obtain  model predictions for each of the four experimental conditions for this generalized linear model. To obtain such predictions, we first take a look at the  contrast matrix. We simultaneously have contrasts for two main effects and one interaction:</p>
<p>We obtain the posterior samples for the estimates from the model:</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb508-1"><a href="ch-coding2x2.html#cb508-1" aria-hidden="true"></a>df_postSamp_pDV &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(fit_pDV_AB.sum)</span></code></pre></div>
<p>From these, we can compute the posterior samples for the linear predictions for each group. We see in the contrast matrix how we have to combine the posterior samples for the intercept, main effects, and interaction to obtain  latent linear predictions for each condition. The first condition (design cell <span class="math inline">\(A1\)</span>, <span class="math inline">\(B1\)</span>) has a weight of <span class="math inline">\(1\)</span> for the intercept, and then weights of <span class="math inline">\(-0.5\)</span> (for the main effect of <span class="math inline">\(A\)</span>), <span class="math inline">\(-0.5\)</span> (for the main effect of <span class="math inline">\(B\)</span>), and <span class="math inline">\(0.25\)</span> (for the interaction). The posterior samples for the other conditions are computed accordingly.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb509-1"><a href="ch-coding2x2.html#cb509-1" aria-hidden="true"></a>df_postSamp_pDV &lt;-<span class="st"> </span>df_postSamp_pDV <span class="op">%&gt;%</span></span>
<span id="cb509-2"><a href="ch-coding2x2.html#cb509-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">A1_B1 =</span> b_Intercept <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>b_A1 <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>b_B1 <span class="op">+</span></span>
<span id="cb509-3"><a href="ch-coding2x2.html#cb509-3" aria-hidden="true"></a><span class="st">           </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> `</span><span class="dt">b_A1:B1</span><span class="st">`</span>,</span>
<span id="cb509-4"><a href="ch-coding2x2.html#cb509-4" aria-hidden="true"></a>         <span class="dt">A1_B2 =</span> b_Intercept <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>b_A1 <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>b_B1 <span class="op">-</span></span>
<span id="cb509-5"><a href="ch-coding2x2.html#cb509-5" aria-hidden="true"></a><span class="st">           </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> `</span><span class="dt">b_A1:B1</span><span class="st">`</span>,</span>
<span id="cb509-6"><a href="ch-coding2x2.html#cb509-6" aria-hidden="true"></a>         <span class="dt">A2_B1 =</span> b_Intercept <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>b_A1 <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>b_B1 <span class="op">-</span></span>
<span id="cb509-7"><a href="ch-coding2x2.html#cb509-7" aria-hidden="true"></a><span class="st">           </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> `</span><span class="dt">b_A1:B1</span><span class="st">`</span>,</span>
<span id="cb509-8"><a href="ch-coding2x2.html#cb509-8" aria-hidden="true"></a>         <span class="dt">A2_B2 =</span> b_Intercept <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>b_A1 <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>b_B1 <span class="op">+</span></span>
<span id="cb509-9"><a href="ch-coding2x2.html#cb509-9" aria-hidden="true"></a><span class="st">           </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> `</span><span class="dt">b_A1:B1</span><span class="st">`</span>)</span></code></pre></div>
<p>Now, we have computed posterior samples for estimates of the latent linear predictor <span class="math inline">\(\eta\)</span> for each experimental condition. We can look at the posterior means:</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb510-1"><a href="ch-coding2x2.html#cb510-1" aria-hidden="true"></a>df_postSamp_pDV <span class="op">%&gt;%</span></span>
<span id="cb510-2"><a href="ch-coding2x2.html#cb510-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(A1_B1, A1_B2, A2_B1, A2_B2) <span class="op">%&gt;%</span></span>
<span id="cb510-3"><a href="ch-coding2x2.html#cb510-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">colMeans</span>()</span></code></pre></div>
<pre><code>##    A1_B1    A1_B2    A2_B1    A2_B2 
## -1.42601  0.00222 -1.39016  1.37494</code></pre>
<p>This shows that these values are not on the probability scale. Instead, they are on the  (log-odds) scale of the latent linear predictor <span class="math inline">\(\eta\)</span>. For presentation and interpretation of the results, it might be much more informative to look at the condition means in terms of the probabilities of success in each of the four conditions. Given that we have the linear predictions for each condition, this can be easily computed by sending all posterior samples for the linear predictions through the link function. Applying the  logistic function  (<code>plogis()</code> in R) transforms the linear predictors to the  probability scale:<a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a></p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb512-1"><a href="ch-coding2x2.html#cb512-1" aria-hidden="true"></a>df_postSamp_pDV &lt;-<span class="st"> </span>df_postSamp_pDV <span class="op">%&gt;%</span></span>
<span id="cb512-2"><a href="ch-coding2x2.html#cb512-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_A1_B1 =</span> <span class="kw">plogis</span>(A1_B1),</span>
<span id="cb512-3"><a href="ch-coding2x2.html#cb512-3" aria-hidden="true"></a>         <span class="dt">p_A1_B2 =</span> <span class="kw">plogis</span>(A1_B2),</span>
<span id="cb512-4"><a href="ch-coding2x2.html#cb512-4" aria-hidden="true"></a>         <span class="dt">p_A2_B1 =</span> <span class="kw">plogis</span>(A2_B1),</span>
<span id="cb512-5"><a href="ch-coding2x2.html#cb512-5" aria-hidden="true"></a>         <span class="dt">p_A2_B2 =</span> <span class="kw">plogis</span>(A2_B2))</span></code></pre></div>
<p>Now, we have posterior samples for each condition on the probability scale. We can take a look at the posterior means, and see that these closely correspond to the probabilities in the data that we have seen above in Table <a href="ch-coding2x2.html#tab:cTab7Means">7.3</a>.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb513-1"><a href="ch-coding2x2.html#cb513-1" aria-hidden="true"></a>df_postSamp_pDV <span class="op">%&gt;%</span></span>
<span id="cb513-2"><a href="ch-coding2x2.html#cb513-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(p_A1_B1, p_A1_B2, p_A2_B1, p_A2_B2) <span class="op">%&gt;%</span></span>
<span id="cb513-3"><a href="ch-coding2x2.html#cb513-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">colMeans</span>()</span></code></pre></div>
<pre><code>## p_A1_B1 p_A1_B2 p_A2_B1 p_A2_B2 
##   0.200   0.501   0.205   0.792</code></pre>
<p>Of course, the advantage is that we now have posterior samples for these conditions available, and can compute posterior 95% credible intervals (also see Figure <a href="ch-coding2x2.html#fig:figpDV">7.5</a>). Rather than computing these manually, the function  <code>conditional_effects()</code> can do this for us. By default, all main effects and two-way interactions estimated in the model are shown (this can be changed by including, for example, <code>effects = "A:B"</code>).</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb515-1"><a href="ch-coding2x2.html#cb515-1" aria-hidden="true"></a><span class="kw">conditional_effects</span>(fit_pDV_AB.sum, <span class="dt">robust =</span> <span class="ot">FALSE</span>)[]</span></code></pre></div>
<pre><code>## $A
##    A   pDV  B cond__ effect1__ estimate__   se__ lower__ upper__
## 1 A1 0.425 B1      1        A1      0.200 0.0553   0.103   0.319
## 2 A2 0.425 B1      1        A2      0.205 0.0549   0.110   0.322
## 
## $B
##    B   pDV  A cond__ effect1__ estimate__   se__ lower__ upper__
## 1 B1 0.425 A1      1        B1      0.200 0.0553   0.103   0.319
## 2 B2 0.425 A1      1        B2      0.501 0.0694   0.367   0.634
## 
## $`A:B`
##    A  B   pDV cond__ effect1__ effect2__ estimate__   se__ lower__
## 1 A1 B1 0.425      1        A1        B1      0.200 0.0553   0.103
## 2 A1 B2 0.425      1        A1        B2      0.501 0.0694   0.367
## 3 A2 B1 0.425      1        A2        B1      0.205 0.0549   0.110
## 4 A2 B2 0.425      1        A2        B2      0.792 0.0561   0.672
##   upper__
## 1   0.319
## 2   0.634
## 3   0.322
## 4   0.893</code></pre>
<p>We plot the two-way  interaction using <code>brms</code>, embedding the <code>conditional_effects()</code> call in <code>plot(.)[[1]]</code>. This allows us to select the first (and here the only) <code>ggplot2</code> element and to customize it.</p>

<div class="sourceCode" id="cb517"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb517-1"><a href="ch-coding2x2.html#cb517-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">conditional_effects</span>(fit_pDV_AB.sum,</span>
<span id="cb517-2"><a href="ch-coding2x2.html#cb517-2" aria-hidden="true"></a>                         <span class="dt">effects =</span> <span class="st">&quot;A:B&quot;</span>,</span>
<span id="cb517-3"><a href="ch-coding2x2.html#cb517-3" aria-hidden="true"></a>                         <span class="dt">robust =</span> <span class="ot">FALSE</span>),</span>
<span id="cb517-4"><a href="ch-coding2x2.html#cb517-4" aria-hidden="true"></a>     <span class="dt">plot =</span> <span class="ot">FALSE</span>)[[<span class="dv">1</span>]] <span class="op">+</span></span>
<span id="cb517-5"><a href="ch-coding2x2.html#cb517-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Success probability&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:figpDV"></span>
<img src="bayescogsci_files/figure-html/figpDV-1.svg" alt="Means and 95 percent posterior credible intervals for a simulated data set of successful task performance in a \(2 \times 2\) design." width="336" />
<p class="caption">
FIGURE 7.5: Means and 95 percent posterior credible intervals for a simulated data set of successful task performance in a <span class="math inline">\(2 \times 2\)</span> design.
</p>
</div>
<p>As a final remark, certain types of interactions might be present at the probability scale, but not at the logit scale (or the other way round); this can happen for any non-linear transformation <span class="citation">(see Loftus <a href="#ref-loftus1978interpretation" role="doc-biblioref">1978</a>; Wagenmakers et al. <a href="#ref-wagenmakers2012interpretation" role="doc-biblioref">2012</a>)</span>.</p>
</div>
<div id="summary-6" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Summary<a href="ch-coding2x2.html#summary-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To summarize, we showed that for contrasts in the context of <span class="math inline">\(2 \times 2\)</span> designs, depending on the contrast coding, the factors estimated nested effects or main effects and interactions. We also saw that it is possible to code contrasts for a <span class="math inline">\(2 \times 2\)</span> design by creating one factor comprising all design cells, and by specifying all effects of interest in a single contrast matrix. In designs with one factor and one covariate it is possible to “control” for group-differences for differences in the covariate (ANCOVA), or to estimate the extent to which regression slopes are parallel in different experimental conditions. Last, in generalized linear models with non-linear link functions it is possible to obtain posterior samples not only on the latent scale of linear predictors, but also on the scale of the response.</p>
</div>
<div id="further-reading-4" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Further reading<a href="ch-coding2x2.html#further-reading-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Analysis of variance is discussed in detail in <span class="citation">Maxwell, Delaney, and Kelley (<a href="#ref-dead" role="doc-biblioref">2017</a>)</span>. A practical book on ANOVA using R is <span class="citation">Faraway (<a href="#ref-faraway2002practical" role="doc-biblioref">2002</a>)</span>.</p>

</div>
</div>



<h3>References</h3>
<div id="refs" class="references hanging-indent">
<div id="ref-faraway2002practical">
<p>Faraway, Julian James. 2002. <em>Practical Regression and ANOVA using R</em>. Vol. 168. Citeseer.</p>
</div>
<div id="ref-loftus1978interpretation">
<p>Loftus, Geoffrey R. 1978. “On Interpretation of Interactions.” <em>Memory &amp; Cognition</em> 6 (3): 312–19.</p>
</div>
<div id="ref-dead">
<p>Maxwell, Scott E, Harold D Delaney, and Ken Kelley. 2017. <em>Designing Experiments and Analyzing Data: A Model Comparison Perspective</em>. New York, NY: Routledge.</p>
</div>
<div id="ref-nieuwenhuis2011erroneous">
<p>Nieuwenhuis, Sander, Birte U Forstmann, and Eric-Jan Wagenmakers. 2011. “Erroneous Analyses of Interactions in Neuroscience: A Problem of Significance.” <em>Nature Neuroscience</em> 14 (9): 1105–7.</p>
</div>
<div id="ref-schadHowCapitalizePriori2020">
<p>Schad, Daniel J., Shravan Vasishth, Sven Hohenstein, and Reinhold Kliegl. 2020. “How to Capitalize on a Priori Contrasts in Linear (Mixed) Models: A Tutorial.” <em>Journal of Memory and Language</em> 110 (February): 104038. <a href="https://doi.org/10/gf9tjp">https://doi.org/10/gf9tjp</a>.</p>
</div>
<div id="ref-wagenmakers2012interpretation">
<p>Wagenmakers, Eric-Jan, Angelos-Miltiadis Krypotos, Amy H Criss, and Geoffrey Iverson. 2012. “On the Interpretation of Removable Interactions: A Survey of the Field 33 Years After Loftus.” <em>Memory &amp; Cognition</em> 40: 145–60.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="31">
<li id="fn31"><p>The same (with lower precision) can be achieved using <code>1/(1+exp(-.))</code>.<a href="ch-coding2x2.html#fnref31" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-contr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-introstan.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
